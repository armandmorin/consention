import{r as v,a as ps,g as ys,c as q,u as ot,L as V,b as Ce,N as Le,d as Lt,B as bs,R as vs,e as I,f as ws}from"./react-vendor-1aea0252.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();var Dt={exports:{}},De={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var js=v,Ns=Symbol.for("react.element"),_s=Symbol.for("react.fragment"),Cs=Object.prototype.hasOwnProperty,ks=js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ss={key:!0,ref:!0,__self:!0,__source:!0};function Ft(a,t,s){var r,n={},i=null,o=null;s!==void 0&&(i=""+s),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)Cs.call(t,r)&&!Ss.hasOwnProperty(r)&&(n[r]=t[r]);if(a&&a.defaultProps)for(r in t=a.defaultProps,t)n[r]===void 0&&(n[r]=t[r]);return{$$typeof:Ns,type:a,key:i,ref:o,props:n,_owner:ks.current}}De.Fragment=_s;De.jsx=Ft;De.jsxs=Ft;Dt.exports=De;var e=Dt.exports,Xe={},vt=ps;Xe.createRoot=vt.createRoot,Xe.hydrateRoot=vt.hydrateRoot;var As={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Es=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ts=(a,t)=>{const s=v.forwardRef(({color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:l,...c},h)=>v.createElement("svg",{ref:h,...As,width:n,height:n,stroke:r,strokeWidth:o?Number(i)*24/Number(n):i,className:`lucide lucide-${Es(a)}`,...c},[...t.map(([d,u])=>v.createElement(d,u)),...(Array.isArray(l)?l:[l])||[]]));return s.displayName=`${a}`,s};var T=Ts;const Ps=T("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Rs=T("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),Os=T("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Ut=T("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),W=T("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),$s=T("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),lt=T("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Is=T("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),me=T("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]),Ls=T("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),ct=T("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),dt=T("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Ds=T("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),He=T("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),Fs=T("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Us=T("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Bs=T("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Ms=T("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Bt=T("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),ht=T("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),Mt=T("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),qs=T("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]),qt=T("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),ut=T("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),zt=T("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Oe=T("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ne=T("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),$e=T("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),mt=T("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),zs=T("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),fe=T("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),ft=T("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Js="modulepreload",Gs=function(a){return"/"+a},wt={},xe=function(t,s,r){if(!s||s.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(s.map(i=>{if(i=Gs(i),i in wt)return;wt[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=n.length-1;d>=0;d--){const u=n[d];if(u.href===i&&(!o||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const h=document.createElement("link");if(h.rel=o?"stylesheet":Js,o||(h.as="script",h.crossOrigin=""),h.href=i,document.head.appendChild(h),o)return new Promise((d,u)=>{h.addEventListener("load",d),h.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},Hs=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...s)=>xe(()=>Promise.resolve().then(()=>pe),void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)};class xt extends Error{constructor(t,s="FunctionsError",r){super(t),this.name=s,this.context=r}}class Vs extends xt{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Ws extends xt{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ks extends xt{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Ze;(function(a){a.Any="any",a.ApNortheast1="ap-northeast-1",a.ApNortheast2="ap-northeast-2",a.ApSouth1="ap-south-1",a.ApSoutheast1="ap-southeast-1",a.ApSoutheast2="ap-southeast-2",a.CaCentral1="ca-central-1",a.EuCentral1="eu-central-1",a.EuWest1="eu-west-1",a.EuWest2="eu-west-2",a.EuWest3="eu-west-3",a.SaEast1="sa-east-1",a.UsEast1="us-east-1",a.UsWest1="us-west-1",a.UsWest2="us-west-2"})(Ze||(Ze={}));var Ys=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};class Qs{constructor(t,{headers:s={},customFetch:r,region:n=Ze.Any}={}){this.url=t,this.headers=s,this.region=n,this.fetch=Hs(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,s={}){var r;return Ys(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=s;let l={},{region:c}=s;c||(c=this.region),c&&c!=="any"&&(l["x-region"]=c);let h;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",h=o):typeof o=="string"?(l["Content-Type"]="text/plain",h=o):typeof FormData<"u"&&o instanceof FormData?h=o:(l["Content-Type"]="application/json",h=JSON.stringify(o)));const d=yield this.fetch(`${this.url}/${t}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),n),body:h}).catch(x=>{throw new Vs(x)}),u=d.headers.get("x-relay-error");if(u&&u==="true")throw new Ws(d);if(!d.ok)throw new Ks(d);let m=((r=d.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),g;return m==="application/json"?g=yield d.json():m==="application/octet-stream"?g=yield d.blob():m==="text/event-stream"?g=d:m==="multipart/form-data"?g=yield d.formData():g=yield d.text(),{data:g,error:null}}catch(n){return{data:null,error:n}}})}}var F={},gt={},Fe={},ke={},Ue={},Be={},Xs=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ge=Xs();const Zs=ge.fetch,Jt=ge.fetch.bind(ge),Gt=ge.Headers,er=ge.Request,tr=ge.Response,pe=Object.freeze(Object.defineProperty({__proto__:null,Headers:Gt,Request:er,Response:tr,default:Jt,fetch:Zs},Symbol.toStringTag,{value:"Module"})),sr=ys(pe);var Me={};Object.defineProperty(Me,"__esModule",{value:!0});let rr=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Me.default=rr;var Ht=q&&q.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Be,"__esModule",{value:!0});const nr=Ht(sr),ar=Ht(Me);let ir=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=nr.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,s){return this.headers=Object.assign({},this.headers),this.headers[t]=s,this}then(t,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let n=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c;let h=null,d=null,u=null,m=i.status,g=i.statusText;if(i.ok){if(this.method!=="HEAD"){const f=await i.text();f===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=f:d=JSON.parse(f))}const b=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),w=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");b&&w&&w.length>1&&(u=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(h={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,u=null,m=406,g="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const b=await i.text();try{h=JSON.parse(b),Array.isArray(h)&&i.status===404&&(d=[],h=null,m=200,g="OK")}catch{i.status===404&&b===""?(m=204,g="No Content"):h={message:b}}if(h&&this.isMaybeSingle&&(!((c=h==null?void 0:h.details)===null||c===void 0)&&c.includes("0 rows"))&&(h=null,m=200,g="OK"),h&&this.shouldThrowOnError)throw new ar.default(h)}return{error:h,data:d,count:u,status:m,statusText:g}});return this.shouldThrowOnError||(n=n.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),n.then(t,s)}returns(){return this}overrideTypes(){return this}};Be.default=ir;var or=q&&q.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ue,"__esModule",{value:!0});const lr=or(Be);let cr=class extends lr.default{select(t){let s=!1;const r=(t??"*").split("").map(n=>/\s/.test(n)&&!s?"":(n==='"'&&(s=!s),n)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:s=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${s?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:s,referencedTable:r=s}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,s,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${s-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:s=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,s?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),h=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${h}"; options=${c};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Ue.default=cr;var dr=q&&q.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ke,"__esModule",{value:!0});const hr=dr(Ue);let ur=class extends hr.default{eq(t,s){return this.url.searchParams.append(t,`eq.${s}`),this}neq(t,s){return this.url.searchParams.append(t,`neq.${s}`),this}gt(t,s){return this.url.searchParams.append(t,`gt.${s}`),this}gte(t,s){return this.url.searchParams.append(t,`gte.${s}`),this}lt(t,s){return this.url.searchParams.append(t,`lt.${s}`),this}lte(t,s){return this.url.searchParams.append(t,`lte.${s}`),this}like(t,s){return this.url.searchParams.append(t,`like.${s}`),this}likeAllOf(t,s){return this.url.searchParams.append(t,`like(all).{${s.join(",")}}`),this}likeAnyOf(t,s){return this.url.searchParams.append(t,`like(any).{${s.join(",")}}`),this}ilike(t,s){return this.url.searchParams.append(t,`ilike.${s}`),this}ilikeAllOf(t,s){return this.url.searchParams.append(t,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(t,s){return this.url.searchParams.append(t,`ilike(any).{${s.join(",")}}`),this}is(t,s){return this.url.searchParams.append(t,`is.${s}`),this}in(t,s){const r=Array.from(new Set(s)).map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cs.{${s.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(s)}`),this}containedBy(t,s){return typeof s=="string"?this.url.searchParams.append(t,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(t,`cd.{${s.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(s)}`),this}rangeGt(t,s){return this.url.searchParams.append(t,`sr.${s}`),this}rangeGte(t,s){return this.url.searchParams.append(t,`nxl.${s}`),this}rangeLt(t,s){return this.url.searchParams.append(t,`sl.${s}`),this}rangeLte(t,s){return this.url.searchParams.append(t,`nxr.${s}`),this}rangeAdjacent(t,s){return this.url.searchParams.append(t,`adj.${s}`),this}overlaps(t,s){return typeof s=="string"?this.url.searchParams.append(t,`ov.${s}`):this.url.searchParams.append(t,`ov.{${s.join(",")}}`),this}textSearch(t,s,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${i}fts${o}.${s}`),this}match(t){return Object.entries(t).forEach(([s,r])=>{this.url.searchParams.append(s,`eq.${r}`)}),this}not(t,s,r){return this.url.searchParams.append(t,`not.${s}.${r}`),this}or(t,{foreignTable:s,referencedTable:r=s}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,s,r){return this.url.searchParams.append(t,`${s}.${r}`),this}};ke.default=ur;var mr=q&&q.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Fe,"__esModule",{value:!0});const be=mr(ke);let fr=class{constructor(t,{headers:s={},schema:r,fetch:n}){this.url=t,this.headers=s,this.schema=r,this.fetch=n}select(t,{head:s=!1,count:r}={}){const n=s?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new be.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:s,defaultToNull:r=!0}={}){const n="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),s&&i.push(`count=${s}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new be.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:s,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&l.push(this.headers.Prefer),n&&l.push(`count=${n}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const c=t.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(c.length>0){const h=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new be.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:s}={}){const r="PATCH",n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),s&&n.push(`count=${s}`),this.headers.Prefer=n.join(","),new be.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const s="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new be.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Fe.default=fr;var qe={},ze={};Object.defineProperty(ze,"__esModule",{value:!0});ze.version=void 0;ze.version="0.0.0-automated";Object.defineProperty(qe,"__esModule",{value:!0});qe.DEFAULT_HEADERS=void 0;const xr=ze;qe.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${xr.version}`};var Vt=q&&q.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(gt,"__esModule",{value:!0});const gr=Vt(Fe),pr=Vt(ke),yr=qe;let br=class Wt{constructor(t,{headers:s={},schema:r,fetch:n}={}){this.url=t,this.headers=Object.assign(Object.assign({},yr.DEFAULT_HEADERS),s),this.schemaName=r,this.fetch=n}from(t){const s=new URL(`${this.url}/${t}`);return new gr.default(s,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Wt(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,s={},{head:r=!1,get:n=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${t}`);let c;r||n?(o=r?"HEAD":"GET",Object.entries(s).filter(([d,u])=>u!==void 0).map(([d,u])=>[d,Array.isArray(u)?`{${u.join(",")}}`:`${u}`]).forEach(([d,u])=>{l.searchParams.append(d,u)})):(o="POST",c=s);const h=Object.assign({},this.headers);return i&&(h.Prefer=`count=${i}`),new pr.default({method:o,url:l,headers:h,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};gt.default=br;var ye=q&&q.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(F,"__esModule",{value:!0});F.PostgrestError=F.PostgrestBuilder=F.PostgrestTransformBuilder=F.PostgrestFilterBuilder=F.PostgrestQueryBuilder=F.PostgrestClient=void 0;const Kt=ye(gt);F.PostgrestClient=Kt.default;const Yt=ye(Fe);F.PostgrestQueryBuilder=Yt.default;const Qt=ye(ke);F.PostgrestFilterBuilder=Qt.default;const Xt=ye(Ue);F.PostgrestTransformBuilder=Xt.default;const Zt=ye(Be);F.PostgrestBuilder=Zt.default;const es=ye(Me);F.PostgrestError=es.default;var vr=F.default={PostgrestClient:Kt.default,PostgrestQueryBuilder:Yt.default,PostgrestFilterBuilder:Qt.default,PostgrestTransformBuilder:Xt.default,PostgrestBuilder:Zt.default,PostgrestError:es.default};const{PostgrestClient:wr,PostgrestQueryBuilder:Ca,PostgrestFilterBuilder:ka,PostgrestTransformBuilder:Sa,PostgrestBuilder:Aa,PostgrestError:Ea}=vr,jr="2.11.2",Nr={"X-Client-Info":`realtime-js/${jr}`},_r="1.0.0",ts=1e4,Cr=1e3;var ue;(function(a){a[a.connecting=0]="connecting",a[a.open=1]="open",a[a.closing=2]="closing",a[a.closed=3]="closed"})(ue||(ue={}));var U;(function(a){a.closed="closed",a.errored="errored",a.joined="joined",a.joining="joining",a.leaving="leaving"})(U||(U={}));var J;(function(a){a.close="phx_close",a.error="phx_error",a.join="phx_join",a.reply="phx_reply",a.leave="phx_leave",a.access_token="access_token"})(J||(J={}));var et;(function(a){a.websocket="websocket"})(et||(et={}));var ne;(function(a){a.Connecting="connecting",a.Open="open",a.Closing="closing",a.Closed="closed"})(ne||(ne={}));class kr{constructor(){this.HEADER_LENGTH=1}decode(t,s){return t.constructor===ArrayBuffer?s(this._binaryDecode(t)):s(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const s=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,s,r)}_decodeBroadcast(t,s,r){const n=s.getUint8(1),i=s.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(t.slice(o,o+n));o=o+n;const c=r.decode(t.slice(o,o+i));o=o+i;const h=JSON.parse(r.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:h}}}class ss{constructor(t,s){this.callback=t,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var P;(function(a){a.abstime="abstime",a.bool="bool",a.date="date",a.daterange="daterange",a.float4="float4",a.float8="float8",a.int2="int2",a.int4="int4",a.int4range="int4range",a.int8="int8",a.int8range="int8range",a.json="json",a.jsonb="jsonb",a.money="money",a.numeric="numeric",a.oid="oid",a.reltime="reltime",a.text="text",a.time="time",a.timestamp="timestamp",a.timestamptz="timestamptz",a.timetz="timetz",a.tsrange="tsrange",a.tstzrange="tstzrange"})(P||(P={}));const jt=(a,t,s={})=>{var r;const n=(r=s.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((i,o)=>(i[o]=Sr(o,a,t,n),i),{})},Sr=(a,t,s,r)=>{const n=t.find(l=>l.name===a),i=n==null?void 0:n.type,o=s[a];return i&&!r.includes(i)?rs(i,o):tt(o)},rs=(a,t)=>{if(a.charAt(0)==="_"){const s=a.slice(1,a.length);return Pr(t,s)}switch(a){case P.bool:return Ar(t);case P.float4:case P.float8:case P.int2:case P.int4:case P.int8:case P.numeric:case P.oid:return Er(t);case P.json:case P.jsonb:return Tr(t);case P.timestamp:return Rr(t);case P.abstime:case P.date:case P.daterange:case P.int4range:case P.int8range:case P.money:case P.reltime:case P.text:case P.time:case P.timestamptz:case P.timetz:case P.tsrange:case P.tstzrange:return tt(t);default:return tt(t)}},tt=a=>a,Ar=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},Er=a=>{if(typeof a=="string"){const t=parseFloat(a);if(!Number.isNaN(t))return t}return a},Tr=a=>{if(typeof a=="string")try{return JSON.parse(a)}catch(t){return console.log(`JSON parse error: ${t}`),a}return a},Pr=(a,t)=>{if(typeof a!="string")return a;const s=a.length-1,r=a[s];if(a[0]==="{"&&r==="}"){let i;const o=a.slice(1,s);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>rs(t,l))}return a},Rr=a=>typeof a=="string"?a.replace(" ","T"):a,ns=a=>{let t=a;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Ve{constructor(t,s,r={},n=ts){this.channel=t,this.event=s,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,s){var r;return this._hasReceived(t)&&s((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:s}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(s))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Nt;(function(a){a.SYNC="sync",a.JOIN="join",a.LEAVE="leave"})(Nt||(Nt={}));class we{constructor(t,s){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},n=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=we.syncState(this.state,n,i,o),this.pendingDiffs.forEach(c=>{this.state=we.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=we.syncDiff(this.state,n,i,o),l())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,s,r,n){const i=this.cloneDeep(t),o=this.transformState(s),l={},c={};return this.map(i,(h,d)=>{o[h]||(c[h]=d)}),this.map(o,(h,d)=>{const u=i[h];if(u){const m=d.map(w=>w.presence_ref),g=u.map(w=>w.presence_ref),x=d.filter(w=>g.indexOf(w.presence_ref)<0),b=u.filter(w=>m.indexOf(w.presence_ref)<0);x.length>0&&(l[h]=x),b.length>0&&(c[h]=b)}else l[h]=d}),this.syncDiff(i,{joins:l,leaves:c},r,n)}static syncDiff(t,s,r,n){const{joins:i,leaves:o}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(l,c)=>{var h;const d=(h=t[l])!==null&&h!==void 0?h:[];if(t[l]=this.cloneDeep(c),d.length>0){const u=t[l].map(g=>g.presence_ref),m=d.filter(g=>u.indexOf(g.presence_ref)<0);t[l].unshift(...m)}r(l,d,c)}),this.map(o,(l,c)=>{let h=t[l];if(!h)return;const d=c.map(u=>u.presence_ref);h=h.filter(u=>d.indexOf(u.presence_ref)<0),t[l]=h,n(l,h,c),h.length===0&&delete t[l]}),t}static map(t,s){return Object.getOwnPropertyNames(t).map(r=>s(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((s,r)=>{const n=t[r];return"metas"in n?s[r]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):s[r]=n,s},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var _t;(function(a){a.ALL="*",a.INSERT="INSERT",a.UPDATE="UPDATE",a.DELETE="DELETE"})(_t||(_t={}));var Ct;(function(a){a.BROADCAST="broadcast",a.PRESENCE="presence",a.POSTGRES_CHANGES="postgres_changes",a.SYSTEM="system"})(Ct||(Ct={}));var H;(function(a){a.SUBSCRIBED="SUBSCRIBED",a.TIMED_OUT="TIMED_OUT",a.CLOSED="CLOSED",a.CHANNEL_ERROR="CHANNEL_ERROR"})(H||(H={}));class pt{constructor(t,s={config:{}},r){this.topic=t,this.params=s,this.socket=r,this.bindings={},this.state=U.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new Ve(this,J.join,this.params,this.timeout),this.rejoinTimer=new ss(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=U.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=U.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=U.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=U.errored,this.rejoinTimer.scheduleTimeout())}),this._on(J.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new we(this),this.broadcastEndpointURL=ns(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,s=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:o,private:l}}=this.params;this._onError(d=>t==null?void 0:t(H.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(H.CLOSED));const c={},h={broadcast:i,presence:o,postgres_changes:(n=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(d=>d.filter))!==null&&n!==void 0?n:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:h},c)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:d})=>{var u;if(this.socket.setAuth(),d===void 0){t==null||t(H.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,g=(u=m==null?void 0:m.length)!==null&&u!==void 0?u:0,x=[];for(let b=0;b<g;b++){const w=m[b],{filter:{event:f,schema:N,table:p,filter:y}}=w,S=d&&d[b];if(S&&S.event===f&&S.schema===N&&S.table===p&&S.filter===y)x.push(Object.assign(Object.assign({},w),{id:S.id}));else{this.unsubscribe(),t==null||t(H.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(H.SUBSCRIBED);return}}).receive("error",d=>{t==null||t(H.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(H.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,s={}){return await this.send({type:"presence",event:"track",payload:t},s.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,s,r){return this._on(t,s,r)}async send(t,s={}){var r,n;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);return await((n=h.body)===null||n===void 0?void 0:n.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const h=this._push(t.type,t,s.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),h.receive("ok",()=>i("ok")),h.receive("error",()=>i("error")),h.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=U.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(J.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const n=new Ve(this,J.leave,{},t);n.receive("ok",()=>{s(),r("ok")}).receive("timeout",()=>{s(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}async _fetchWithTimeout(t,s,r){const n=new AbortController,i=setTimeout(()=>n.abort(),r),o=await this.socket.fetch(t,Object.assign(Object.assign({},s),{signal:n.signal}));return clearTimeout(i),o}_push(t,s,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Ve(this,t,s,r);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(t,s,r){return s}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,s,r){var n,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:h,join:d}=J;if(r&&[l,c,h,d].indexOf(o)>=0&&r!==this._joinRef())return;let m=this._onMessage(o,s,r);if(s&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(g=>{var x,b,w;return((x=g.filter)===null||x===void 0?void 0:x.event)==="*"||((w=(b=g.filter)===null||b===void 0?void 0:b.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===o}).map(g=>g.callback(m,r)):(i=this.bindings[o])===null||i===void 0||i.filter(g=>{var x,b,w,f,N,p;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in g){const y=g.id,S=(x=g.filter)===null||x===void 0?void 0:x.event;return y&&((b=s.ids)===null||b===void 0?void 0:b.includes(y))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((w=s.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const y=(N=(f=g==null?void 0:g.filter)===null||f===void 0?void 0:f.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return y==="*"||y===((p=s==null?void 0:s.event)===null||p===void 0?void 0:p.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===o}).map(g=>{if(typeof m=="object"&&"ids"in m){const x=m.data,{schema:b,table:w,commit_timestamp:f,type:N,errors:p}=x;m=Object.assign(Object.assign({},{schema:b,table:w,commit_timestamp:f,eventType:N,new:{},old:{},errors:p}),this._getPayloadRecords(x))}g.callback(m,r)})}_isClosed(){return this.state===U.closed}_isJoined(){return this.state===U.joined}_isJoining(){return this.state===U.joining}_isLeaving(){return this.state===U.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,s,r){const n=t.toLocaleLowerCase(),i={type:n,filter:s,callback:r};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(t,s){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&pt.isEqual(n.filter,s))}),this}static isEqual(t,s){if(Object.keys(t).length!==Object.keys(s).length)return!1;for(const r in t)if(t[r]!==s[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(J.close,{},t)}_onError(t){this._on(J.error,{},s=>t(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=U.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const s={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(s.new=jt(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(s.old=jt(t.columns,t.old_record)),s}}const Or=()=>{},$r=typeof WebSocket<"u",Ir=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Lr{constructor(t,s){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Nr,this.params={},this.timeout=ts,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Or,this.conn=null,this.sendBuffer=[],this.serializer=new kr,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>xe(()=>Promise.resolve().then(()=>pe),void 0).then(({default:c})=>c(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${t}/${et.websocket}`,this.httpEndpoint=ns(t),s!=null&&s.transport?this.transport=s.transport:this.transport=null,s!=null&&s.params&&(this.params=s.params),s!=null&&s.headers&&(this.headers=Object.assign(Object.assign({},this.headers),s.headers)),s!=null&&s.timeout&&(this.timeout=s.timeout),s!=null&&s.logger&&(this.logger=s.logger),s!=null&&s.heartbeatIntervalMs&&(this.heartbeatIntervalMs=s.heartbeatIntervalMs);const n=(r=s==null?void 0:s.params)===null||r===void 0?void 0:r.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=s!=null&&s.reconnectAfterMs?s.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=s!=null&&s.encode?s.encode:(i,o)=>o(JSON.stringify(i)),this.decode=s!=null&&s.decode?s.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new ss(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(s==null?void 0:s.fetch),s!=null&&s.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(s==null?void 0:s.worker)||!1,this.workerUrl=s==null?void 0:s.workerUrl}this.accessToken=(s==null?void 0:s.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if($r){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Dr(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),xe(()=>import("./browser-462367c8.js").then(t=>t.b),["assets/browser-462367c8.js","assets/react-vendor-1aea0252.js"]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:_r}))}disconnect(t,s){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,s??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const s=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const t=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.disconnect(),t}log(t,s,r){this.logger(t,s,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ue.connecting:return ne.Connecting;case ue.open:return ne.Open;case ue.closing:return ne.Closing;default:return ne.Closed}}isConnected(){return this.connectionState()===ne.Open}channel(t,s={config:{}}){const r=new pt(`realtime:${t}`,s,this);return this.channels.push(r),r}push(t){const{topic:s,event:r,payload:n,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${s} ${r} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){let s=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(s){let r=null;try{r=JSON.parse(atob(s.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=s,this.channels.forEach(n=>{s&&n.updateJoinPayload({access_token:s}),n.joinedOnce&&n._isJoined()&&n._push(J.access_token,{access_token:s})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(Cr,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let s=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${t}"`),s.unsubscribe())}_remove(t){this.channels=this.channels.filter(s=>s._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,s=>{let{topic:r,event:n,payload:i,ref:o}=s;o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${n} ${o&&"("+o+")"||""}`,i),this.channels.filter(l=>l._isMember(r)).forEach(l=>l._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(s))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(s=>s(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(s=>s(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(J.error))}_appendParams(t,s){if(Object.keys(s).length===0)return t;const r=t.match(/\?/)?"&":"?",n=new URLSearchParams(s);return`${t}${r}${n}`}_workerObjectUrl(t){let s;if(t)s=t;else{const r=new Blob([Ir],{type:"application/javascript"});s=URL.createObjectURL(r)}return s}}class Dr{constructor(t,s,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ue.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=r.close}}class yt extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function O(a){return typeof a=="object"&&a!==null&&"__isStorageError"in a}class Fr extends yt{constructor(t,s){super(t),this.name="StorageApiError",this.status=s}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class st extends yt{constructor(t,s){super(t),this.name="StorageUnknownError",this.originalError=s}}var Ur=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};const as=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...s)=>xe(()=>Promise.resolve().then(()=>pe),void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)},Br=()=>Ur(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield xe(()=>Promise.resolve().then(()=>pe),void 0)).Response:Response}),rt=a=>{if(Array.isArray(a))return a.map(s=>rt(s));if(typeof a=="function"||a!==Object(a))return a;const t={};return Object.entries(a).forEach(([s,r])=>{const n=s.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[n]=rt(r)}),t};var ae=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};const We=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),Mr=(a,t,s)=>ae(void 0,void 0,void 0,function*(){const r=yield Br();a instanceof r&&!(s!=null&&s.noResolveJson)?a.json().then(n=>{t(new Fr(We(n),a.status||500))}).catch(n=>{t(new st(We(n),n))}):t(new st(We(a),a))}),qr=(a,t,s,r)=>{const n={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r&&(n.body=JSON.stringify(r)),Object.assign(Object.assign({},n),s))};function Se(a,t,s,r,n,i){return ae(this,void 0,void 0,function*(){return new Promise((o,l)=>{a(s,qr(t,r,n,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Mr(c,l,r))})})}function Ie(a,t,s,r){return ae(this,void 0,void 0,function*(){return Se(a,"GET",t,s,r)})}function Q(a,t,s,r,n){return ae(this,void 0,void 0,function*(){return Se(a,"POST",t,r,n,s)})}function zr(a,t,s,r,n){return ae(this,void 0,void 0,function*(){return Se(a,"PUT",t,r,n,s)})}function Jr(a,t,s,r){return ae(this,void 0,void 0,function*(){return Se(a,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)})}function is(a,t,s,r,n){return ae(this,void 0,void 0,function*(){return Se(a,"DELETE",t,r,n,s)})}var D=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};const Gr={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},kt={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Hr{constructor(t,s={},r,n){this.url=t,this.headers=s,this.bucketId=r,this.fetch=as(n)}uploadOrUpdate(t,s,r,n){return D(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},kt),n);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const h=this._removeEmptyFolders(s),d=this._getFinalPath(h),u=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:i,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),m=yield u.json();return u.ok?{data:{path:h,id:m.Id,fullPath:m.Key},error:null}:{data:null,error:m}}catch(i){if(O(i))return{data:null,error:i};throw i}})}upload(t,s,r){return D(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,s,r)})}uploadToSignedUrl(t,s,r,n){return D(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",s);try{let c;const h=Object.assign({upsert:kt.upsert},n),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",h.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",h.cacheControl)):(c=r,d["cache-control"]=`max-age=${h.cacheControl}`,d["content-type"]=h.contentType);const u=yield this.fetch(l.toString(),{method:"PUT",body:c,headers:d}),m=yield u.json();return u.ok?{data:{path:i,fullPath:m.Key},error:null}:{data:null,error:m}}catch(c){if(O(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,s){return D(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const n=Object.assign({},this.headers);s!=null&&s.upsert&&(n["x-upsert"]="true");const i=yield Q(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new yt("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(r){if(O(r))return{data:null,error:r};throw r}})}update(t,s,r){return D(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,s,r)})}move(t,s,r){return D(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(O(n))return{data:null,error:n};throw n}})}copy(t,s,r){return D(this,void 0,void 0,function*(){try{return{data:{path:(yield Q(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:s,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(O(n))return{data:null,error:n};throw n}})}createSignedUrl(t,s,r){return D(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t),i=yield Q(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:s},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(O(n))return{data:null,error:n};throw n}})}createSignedUrls(t,s,r){return D(this,void 0,void 0,function*(){try{const n=yield Q(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:t},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(O(n))return{data:null,error:n};throw n}})}download(t,s){return D(this,void 0,void 0,function*(){const n=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield Ie(this.fetch,`${this.url}/${n}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(O(l))return{data:null,error:l};throw l}})}info(t){return D(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{const r=yield Ie(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:rt(r),error:null}}catch(r){if(O(r))return{data:null,error:r};throw r}})}exists(t){return D(this,void 0,void 0,function*(){const s=this._getFinalPath(t);try{return yield Jr(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(O(r)&&r instanceof st){const n=r.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,s){const r=this._getFinalPath(t),n=[],i=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";i!==""&&n.push(i);const l=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});c!==""&&n.push(c);let h=n.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${h}`)}}}remove(t){return D(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(s){if(O(s))return{data:null,error:s};throw s}})}list(t,s,r){return D(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Gr),s),{prefix:t||""});return{data:yield Q(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(O(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const s=[];return t.width&&s.push(`width=${t.width}`),t.height&&s.push(`height=${t.height}`),t.resize&&s.push(`resize=${t.resize}`),t.format&&s.push(`format=${t.format}`),t.quality&&s.push(`quality=${t.quality}`),s.join("&")}}const Vr="2.7.1",Wr={"X-Client-Info":`storage-js/${Vr}`};var le=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};class Kr{constructor(t,s={},r){this.url=t,this.headers=Object.assign(Object.assign({},Wr),s),this.fetch=as(r)}listBuckets(){return le(this,void 0,void 0,function*(){try{return{data:yield Ie(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(O(t))return{data:null,error:t};throw t}})}getBucket(t){return le(this,void 0,void 0,function*(){try{return{data:yield Ie(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(s){if(O(s))return{data:null,error:s};throw s}})}createBucket(t,s={public:!1}){return le(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(O(r))return{data:null,error:r};throw r}})}updateBucket(t,s){return le(this,void 0,void 0,function*(){try{return{data:yield zr(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(O(r))return{data:null,error:r};throw r}})}emptyBucket(t){return le(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(O(s))return{data:null,error:s};throw s}})}deleteBucket(t){return le(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(s){if(O(s))return{data:null,error:s};throw s}})}}class Yr extends Kr{constructor(t,s={},r){super(t,s,r)}from(t){return new Hr(this.url,this.headers,t,this.fetch)}}const Qr="2.49.1";let ve="";typeof Deno<"u"?ve="deno":typeof document<"u"?ve="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ve="react-native":ve="node";const Xr={"X-Client-Info":`supabase-js-${ve}/${Qr}`},Zr={headers:Xr},en={schema:"public"},tn={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},sn={};var rn=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};const nn=a=>{let t;return a?t=a:typeof fetch>"u"?t=Jt:t=fetch,(...s)=>t(...s)},an=()=>typeof Headers>"u"?Gt:Headers,on=(a,t,s)=>{const r=nn(s),n=an();return(i,o)=>rn(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:a;let h=new n(o==null?void 0:o.headers);return h.has("apikey")||h.set("apikey",a),h.has("Authorization")||h.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:h}))})};var ln=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};function cn(a){return a.replace(/\/$/,"")}function dn(a,t){const{db:s,auth:r,realtime:n,global:i}=a,{db:o,auth:l,realtime:c,global:h}=t,d={db:Object.assign(Object.assign({},o),s),auth:Object.assign(Object.assign({},l),r),realtime:Object.assign(Object.assign({},c),n),global:Object.assign(Object.assign({},h),i),accessToken:()=>ln(this,void 0,void 0,function*(){return""})};return a.accessToken?d.accessToken=a.accessToken:delete d.accessToken,d}const os="2.68.0",he=30*1e3,nt=3,Ke=nt*he,hn="http://localhost:9999",un="supabase.auth.token",mn={"X-Client-Info":`gotrue-js/${os}`},at="X-Supabase-Api-Version",ls={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function fn(a){return Math.round(Date.now()/1e3)+a}function xn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){const t=Math.random()*16|0;return(a=="x"?t:t&3|8).toString(16)})}const G=()=>typeof window<"u"&&typeof document<"u",te={tested:!1,writable:!1},je=()=>{if(!G())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(te.tested)return te.writable;const a=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(a,a),globalThis.localStorage.removeItem(a),te.tested=!0,te.writable=!0}catch{te.tested=!0,te.writable=!1}return te.writable};function gn(a){const t={},s=new URL(a);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((n,i)=>{t[i]=n})}catch{}return s.searchParams.forEach((r,n)=>{t[n]=r}),t}const cs=a=>{let t;return a?t=a:typeof fetch>"u"?t=(...s)=>xe(()=>Promise.resolve().then(()=>pe),void 0).then(({default:r})=>r(...s)):t=fetch,(...s)=>t(...s)},pn=a=>typeof a=="object"&&a!==null&&"status"in a&&"ok"in a&&"json"in a&&typeof a.json=="function",ds=async(a,t,s)=>{await a.setItem(t,JSON.stringify(s))},Ae=async(a,t)=>{const s=await a.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Ee=async(a,t)=>{await a.removeItem(t)};function yn(a){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s="",r,n,i,o,l,c,h,d=0;for(a=a.replace("-","+").replace("_","/");d<a.length;)o=t.indexOf(a.charAt(d++)),l=t.indexOf(a.charAt(d++)),c=t.indexOf(a.charAt(d++)),h=t.indexOf(a.charAt(d++)),r=o<<2|l>>4,n=(l&15)<<4|c>>2,i=(c&3)<<6|h,s=s+String.fromCharCode(r),c!=64&&n!=0&&(s=s+String.fromCharCode(n)),h!=64&&i!=0&&(s=s+String.fromCharCode(i));return s}class Je{constructor(){this.promise=new Je.promiseConstructor((t,s)=>{this.resolve=t,this.reject=s})}}Je.promiseConstructor=Promise;function St(a){const t=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,s=a.split(".");if(s.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!t.test(s[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=s[1];return JSON.parse(yn(r))}async function bn(a){return await new Promise(t=>{setTimeout(()=>t(null),a)})}function vn(a,t){return new Promise((r,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await a(i);if(!t(i,null,o)){r(o);return}}catch(o){if(!t(i,o)){n(o);return}}})()})}function wn(a){return("0"+a.toString(16)).substr(-2)}function jn(){const t=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=s.length;let n="";for(let i=0;i<56;i++)n+=s.charAt(Math.floor(Math.random()*r));return n}return crypto.getRandomValues(t),Array.from(t,wn).join("")}async function Nn(a){const s=new TextEncoder().encode(a),r=await crypto.subtle.digest("SHA-256",s),n=new Uint8Array(r);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}function _n(a){return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Cn(a){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a;const s=await Nn(a);return _n(s)}async function ce(a,t,s=!1){const r=jn();let n=r;s&&(n+="/PASSWORD_RECOVERY"),await ds(a,`${t}-code-verifier`,n);const i=await Cn(r);return[i,r===i?"plain":"s256"]}const kn=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Sn(a){const t=a.headers.get(at);if(!t||!t.match(kn))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}class bt extends Error{constructor(t,s,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=r}}function k(a){return typeof a=="object"&&a!==null&&"__isAuthError"in a}class An extends bt{constructor(t,s,r){super(t,s,r),this.name="AuthApiError",this.status=s,this.code=r}}function En(a){return k(a)&&a.name==="AuthApiError"}class hs extends bt{constructor(t,s){super(t),this.name="AuthUnknownError",this.originalError=s}}class ie extends bt{constructor(t,s,r,n){super(t,r,n),this.name=s,this.status=r}}class K extends ie{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Tn(a){return k(a)&&a.name==="AuthSessionMissingError"}class Ye extends ie{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Te extends ie{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Pe extends ie{constructor(t,s=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Pn(a){return k(a)&&a.name==="AuthImplicitGrantRedirectError"}class At extends ie{constructor(t,s=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class it extends ie{constructor(t,s){super(t,"AuthRetryableFetchError",s,void 0)}}function Qe(a){return k(a)&&a.name==="AuthRetryableFetchError"}class Et extends ie{constructor(t,s,r){super(t,"AuthWeakPasswordError",s,"weak_password"),this.reasons=r}}var Rn=globalThis&&globalThis.__rest||function(a,t){var s={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&t.indexOf(r)<0&&(s[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(a);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(a,r[n])&&(s[r[n]]=a[r[n]]);return s};const re=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),On=[502,503,504];async function Tt(a){var t;if(!pn(a))throw new it(re(a),0);if(On.includes(a.status))throw new it(re(a),a.status);let s;try{s=await a.json()}catch(i){throw new hs(re(i),i)}let r;const n=Sn(a);if(n&&n.getTime()>=ls["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?r=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(r=s.error_code),r){if(r==="weak_password")throw new Et(re(s),a.status,((t=s.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new K}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Et(re(s),a.status,s.weak_password.reasons);throw new An(re(s),a.status||500,r)}const $n=(a,t,s,r)=>{const n={method:a,headers:(t==null?void 0:t.headers)||{}};return a==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),s))};async function E(a,t,s,r){var n;const i=Object.assign({},r==null?void 0:r.headers);i[at]||(i[at]=ls["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(n=r==null?void 0:r.query)!==null&&n!==void 0?n:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await In(a,t,s+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function In(a,t,s,r,n,i){const o=$n(t,r,n,i);let l;try{l=await a(s,Object.assign({},o))}catch(c){throw console.error(c),new it(re(c),0)}if(l.ok||await Tt(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await Tt(c)}}function Y(a){var t;let s=null;Un(a)&&(s=Object.assign({},a),a.expires_at||(s.expires_at=fn(a.expires_in)));const r=(t=a.user)!==null&&t!==void 0?t:a;return{data:{session:s,user:r},error:null}}function Pt(a){const t=Y(a);return!t.error&&a.weak_password&&typeof a.weak_password=="object"&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.message&&typeof a.weak_password.message=="string"&&a.weak_password.reasons.reduce((s,r)=>s&&typeof r=="string",!0)&&(t.data.weak_password=a.weak_password),t}function Z(a){var t;return{data:{user:(t=a.user)!==null&&t!==void 0?t:a},error:null}}function Ln(a){return{data:a,error:null}}function Dn(a){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i}=a,o=Rn(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Fn(a){return a}function Un(a){return a.access_token&&a.refresh_token&&a.expires_in}var Bn=globalThis&&globalThis.__rest||function(a,t){var s={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&t.indexOf(r)<0&&(s[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(a);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(a,r[n])&&(s[r[n]]=a[r[n]]);return s};class Mn{constructor({url:t="",headers:s={},fetch:r}){this.url=t,this.headers=s,this.fetch=cs(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,s="global"){try{return await E(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(k(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,s={}){try{return await E(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Z})}catch(r){if(k(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:s}=t,r=Bn(t,["options"]),n=Object.assign(Object.assign({},r),s);return"newEmail"in r&&(n.new_email=r==null?void 0:r.newEmail,delete n.newEmail),await E(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Dn,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(k(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(t){try{return await E(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Z})}catch(s){if(k(s))return{data:{user:null},error:s};throw s}}async listUsers(t){var s,r,n,i,o,l,c;try{const h={nextPage:null,lastPage:0,total:0},d=await E(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(s=t==null?void 0:t.page)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:"",per_page:(i=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Fn});if(d.error)throw d.error;const u=await d.json(),m=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(x=>{const b=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(x.split(";")[1].split("=")[1]);h[`${w}Page`]=b}),h.total=parseInt(m)),{data:Object.assign(Object.assign({},u),h),error:null}}catch(h){if(k(h))return{data:{users:[]},error:h};throw h}}async getUserById(t){try{return await E(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Z})}catch(s){if(k(s))return{data:{user:null},error:s};throw s}}async updateUserById(t,s){try{return await E(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:s,headers:this.headers,xform:Z})}catch(r){if(k(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,s=!1){try{return await E(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:s},xform:Z})}catch(r){if(k(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){try{const{data:s,error:r}=await E(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:s,error:r}}catch(s){if(k(s))return{data:null,error:s};throw s}}async _deleteFactor(t){try{return{data:await E(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(s){if(k(s))return{data:null,error:s};throw s}}}const qn={getItem:a=>je()?globalThis.localStorage.getItem(a):null,setItem:(a,t)=>{je()&&globalThis.localStorage.setItem(a,t)},removeItem:a=>{je()&&globalThis.localStorage.removeItem(a)}};function Rt(a={}){return{getItem:t=>a[t]||null,setItem:(t,s)=>{a[t]=s},removeItem:t=>{delete a[t]}}}function zn(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const de={debug:!!(globalThis&&je()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class us extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Jn extends us{}async function Gn(a,t,s){de.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",a,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),de.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",a)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(a,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async n=>{if(n){de.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",a,n.name);try{return await s()}finally{de.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",a,n.name)}}else{if(t===0)throw de.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",a),new Jn(`Acquiring an exclusive Navigator LockManager lock "${a}" immediately failed`);if(de.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}zn();const Hn={url:hn,storageKey:un,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mn,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ot(a,t,s){return await s()}class _e{constructor(t){var s,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=_e.nextInstanceID,_e.nextInstanceID+=1,this.instanceID>0&&G()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Hn),t);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Mn({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=cs(n.fetch),this.lock=n.lock||Ot,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:G()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=Gn:this.lock=Ot,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:je()?this.storage=qn:(this.memoryStorage={},this.storage=Rt(this.memoryStorage)):(this.memoryStorage={},this.storage=Rt(this.memoryStorage)),G()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${os}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const s=gn(window.location.href);let r="none";if(this._isImplicitGrantCallback(s)?r="implicit":await this._isPKCECallback(s)&&(r="pkce"),G()&&this.detectSessionInUrl&&r!=="none"){const{data:n,error:i}=await this._getSessionFromURL(s,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Pn(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return k(s)?{error:s}:{error:new hs("Unexpected error during initialization",s)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var s,r,n;try{const i=await E(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:Y}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:h,session:c},error:null}}catch(i){if(k(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var s,r,n;try{let i;if("email"in t){const{email:d,password:u,options:m}=t;let g=null,x=null;this.flowType==="pkce"&&([g,x]=await ce(this.storage,this.storageKey)),i=await E(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:d,password:u,data:(s=m==null?void 0:m.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:g,code_challenge_method:x},xform:Y})}else if("phone"in t){const{phone:d,password:u,options:m}=t;i=await E(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:u,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},channel:(n=m==null?void 0:m.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:Y})}else throw new Te("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,h=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:h,session:c},error:null}}catch(i){if(k(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let s;if("email"in t){const{email:i,password:o,options:l}=t;s=await E(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Pt})}else if("phone"in t){const{phone:i,password:o,options:l}=t;s=await E(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Pt})}else throw new Te("You must provide either an email or phone number and a password");const{data:r,error:n}=s;return n?{data:{user:null,session:null},error:n}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Ye}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n})}catch(s){if(k(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOAuth(t){var s,r,n,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const s=await Ae(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(s??"").split("/");try{const{data:i,error:o}=await E(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:Y});if(await Ee(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Ye}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(k(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:s,provider:r,token:n,access_token:i,nonce:o}=t,l=await E(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:Y}),{data:c,error:h}=l;return h?{data:{user:null,session:null},error:h}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ye}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:h})}catch(s){if(k(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(t){var s,r,n,i,o;try{if("email"in t){const{email:l,options:c}=t;let h=null,d=null;this.flowType==="pkce"&&([h,d]=await ce(this.storage,this.storageKey));const{error:u}=await E(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:h,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in t){const{phone:l,options:c}=t,{data:h,error:d}=await E(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:d}}throw new Te("You must provide either an email or phone number.")}catch(l){if(k(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var s,r;try{let n,i;"options"in t&&(n=(s=t.options)===null||s===void 0?void 0:s.redirectTo,i=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await E(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Y});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,h=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:h,session:c},error:null}}catch(n){if(k(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(t){var s,r,n;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await ce(this.storage,this.storageKey)),await E(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(s=t.options)===null||s===void 0?void 0:s.redirectTo)!==null&&r!==void 0?r:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Ln})}catch(i){if(k(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:s},error:r}=t;if(r)throw r;if(!s)throw new K;const{error:n}=await E(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:n}})}catch(t){if(k(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const s=`${this.url}/resend`;if("email"in t){const{email:r,type:n,options:i}=t,{error:o}=await E(this.fetch,"POST",s,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:r,type:n,options:i}=t,{data:o,error:l}=await E(this.fetch,"POST",s,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Te("You must provide either an email or phone number and a type")}catch(s){if(k(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(t,s){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await r,await s()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=s();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await t(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const s=await Ae(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?t=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<Ke:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,h,d)=>(!o&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,h,d))})}return{data:{session:t},error:null}}const{session:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await E(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Z}):await this._useSession(async s=>{var r,n,i;const{data:o,error:l}=s;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new K}:await E(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Z})})}catch(s){if(k(s))return Tn(s)&&(await this._removeSession(),await Ee(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(t,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,s))}async _updateUser(t,s={}){try{return await this._useSession(async r=>{const{data:n,error:i}=r;if(i)throw i;if(!n.session)throw new K;const o=n.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await ce(this.storage,this.storageKey));const{data:h,error:d}=await E(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Z});if(d)throw d;return o.user=h.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(k(r))return{data:{user:null},error:r};throw r}}_decodeJWT(t){return St(t)}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new K;const s=Date.now()/1e3;let r=s,n=!0,i=null;const o=St(t.access_token);if(o.exp&&(r=o.exp,n=r<=s),n){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:r-s,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(s){if(k(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async s=>{var r;if(!t){const{data:o,error:l}=s;if(l)throw l;t=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new K;const{session:n,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(k(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(t,s){try{if(!G())throw new Pe("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Pe(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new At("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Pe("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new At("No code detected.");const{data:N,error:p}=await this._exchangeCodeForSession(t.code);if(p)throw p;const y=new URL(window.location.href);return y.searchParams.delete("code"),window.history.replaceState(window.history.state,"",y.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:h}=t;if(!i||!l||!o||!h)throw new Pe("No session defined in URL");const d=Math.round(Date.now()/1e3),u=parseInt(l);let m=d+u;c&&(m=parseInt(c));const g=m-d;g*1e3<=he&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${u}s`);const x=m-u;d-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,m,d):d-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,m,d);const{data:b,error:w}=await this._getUser(i);if(w)throw w;const f={provider_token:r,provider_refresh_token:n,access_token:i,expires_in:u,expires_at:m,refresh_token:o,token_type:h,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:f,redirectType:t.type},error:null}}catch(r){if(k(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const s=await Ae(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&s)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async s=>{var r;const{data:n,error:i}=s;if(i)return{error:i};const o=(r=n.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(En(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await Ee(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const s=xn(),r={id:s,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async s=>{var r,n;try{const{data:{session:i},error:o}=s;if(o)throw o;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,s={}){let r=null,n=null;this.flowType==="pkce"&&([r,n]=await ce(this.storage,this.storageKey,!0));try{return await E(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(i){if(k(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:s,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=s.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(s){if(k(s))return{data:null,error:s};throw s}}async linkIdentity(t){var s;try{const{data:r,error:n}=await this._useSession(async i=>{var o,l,c,h,d;const{data:u,error:m}=i;if(m)throw m;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await E(this.fetch,"GET",g,{headers:this.headers,jwt:(d=(h=u.session)===null||h===void 0?void 0:h.access_token)!==null&&d!==void 0?d:void 0})});if(n)throw n;return G()&&!(!((s=t.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(k(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async s=>{var r,n;const{data:i,error:o}=s;if(o)throw o;return await E(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:void 0})})}catch(s){if(k(s))return{data:null,error:s};throw s}}async _refreshAccessToken(t){const s=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{const r=Date.now();return await vn(async n=>(n>0&&await bn(200*Math.pow(2,n-1)),this._debug(s,"refreshing attempt",n),await E(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Y})),(n,i)=>{const o=200*Math.pow(2,n);return i&&Qe(i)&&Date.now()+o-r<he})}catch(r){if(this._debug(s,"error",r),k(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(s,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,s){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",s,"url",r),G()&&!s.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await Ae(this.storage,this.storageKey);if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const n=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Ke;if(this._debug(s,`session has${n?"":" not"} expired with margin of ${Ke}s`),n){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),Qe(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var s,r;if(!t)throw new K;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Je;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new K;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(n,"error",i),k(i)){const o={session:null,error:i};return Qe(i)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,s,r=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",s,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:s});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,s)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await ds(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Ee(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&G()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),he);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async s=>{const{data:{session:r}}=s;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((r.expires_at*1e3-t)/he);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${he}ms, refresh threshold is ${nt} ticks`),n<=nt&&await this._callRefreshToken(r.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof us)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!G()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const s=`#_onVisibilityChanged(${t})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,s,r){const n=[`provider=${encodeURIComponent(s)}`];if(r!=null&&r.redirectTo&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await ce(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);n.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;return i?{data:null,error:i}:await E(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(k(s))return{data:null,error:s};throw s}}async _enroll(t){try{return await this._useSession(async s=>{var r,n;const{data:i,error:o}=s;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:h}=await E(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return h?{data:null,error:h}:(t.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(s){if(k(s))return{data:null,error:s};throw s}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;if(i)return{data:null,error:i};const{data:o,error:l}=await E(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(s){if(k(s))return{data:null,error:s};throw s}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var r;const{data:n,error:i}=s;return i?{data:null,error:i}:await E(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=n==null?void 0:n.session)===null||r===void 0?void 0:r.access_token})})}catch(s){if(k(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(t){const{data:s,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:s.id,code:t.code})}async _listFactors(){const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const r=(t==null?void 0:t.factors)||[],n=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var s,r;const{data:{session:n},error:i}=t;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(n.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(s=n.user.factors)===null||s===void 0?void 0:s.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const d=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}}_e.nextInstanceID=0;const Vn=_e;class Wn extends Vn{constructor(t){super(t)}}var Kn=globalThis&&globalThis.__awaiter||function(a,t,s,r){function n(i){return i instanceof s?i:new s(function(o){o(i)})}return new(s||(s=Promise))(function(i,o){function l(d){try{h(r.next(d))}catch(u){o(u)}}function c(d){try{h(r.throw(d))}catch(u){o(u)}}function h(d){d.done?i(d.value):n(d.value).then(l,c)}h((r=r.apply(a,t||[])).next())})};class Yn{constructor(t,s,r){var n,i,o;if(this.supabaseUrl=t,this.supabaseKey=s,!t)throw new Error("supabaseUrl is required.");if(!s)throw new Error("supabaseKey is required.");const l=cn(t);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;const c=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,h={db:en,realtime:sn,auth:Object.assign(Object.assign({},tn),{storageKey:c}),global:Zr},d=dn(r??{},h);this.storageKey=(n=d.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(u,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=on(s,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new wr(`${l}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new Qs(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Yr(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,s={},r={}){return this.rest.rpc(t,s,r)}channel(t,s={config:{}}){return this.realtime.channel(t,s)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,s;return Kn(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(s=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&s!==void 0?s:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:s,detectSessionInUrl:r,storage:n,storageKey:i,flowType:o,lock:l,debug:c},h,d){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Wn({url:this.authUrl,headers:Object.assign(Object.assign({},u),h),storageKey:i,autoRefreshToken:t,persistSession:s,detectSessionInUrl:r,storage:n,flowType:o,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Lr(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,r)=>{this._handleTokenChanged(s,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,s,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Qn=(a,t,s)=>new Yn(a,t,s),ms="https://fgnvobekfychilwomxij.supabase.co",Xn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZnbnZvYmVrZnljaGlsd29teGlqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA2NzU0NzYsImV4cCI6MjA1NjI1MTQ3Nn0.B1RbG--ygXz0VjuW5mNFprcMeolPMBh5irufwUNusK8",Zn=ms.split("//")[1].split(".")[0],fs=`sb-${Zn}-auth-token`;console.log("Supabase storage key:",fs);const R=Qn(ms,Xn,{auth:{persistSession:!0,storageKey:fs,autoRefreshToken:!0}}),xs=v.createContext(void 0),ea=({children:a})=>{const[t,s]=v.useState(null),[r,n]=v.useState(!0),[i,o]=v.useState(null),l=ot();v.useEffect(()=>{const x=()=>{var p,y,S;try{const A="sb-fgnvobekfychilwomxij-auth-token",$=localStorage.getItem(A);if($){const L=JSON.parse($);if(L!=null&&L.user){const j=L.user;return s({id:j.id,email:j.email||"",name:((p=j.user_metadata)==null?void 0:p.name)||((y=j.email)==null?void 0:y.split("@")[0])||"User",role:((S=j.app_metadata)==null?void 0:S.role)||"client",organization:null}),!0}}return!1}catch(_){return console.error("Error loading user from localStorage:",_),!1}},b=async(p,y)=>{var S,_,A;try{const{data:$}=await R.from("profiles").select("*").eq("id",p).single(),{data:L}=await R.auth.getSession(),j=(A=(_=(S=L==null?void 0:L.session)==null?void 0:S.user)==null?void 0:_.app_metadata)==null?void 0:A.role;if($){let z="client";j==="superadmin"||$.role==="superadmin"?z="superadmin":(j==="admin"||$.role==="admin")&&(z="admin"),s({id:p,email:y||"",name:$.name||"",role:z,organization:$.organization})}else s({id:p,email:y||"",name:(y==null?void 0:y.split("@")[0])||"User",role:j||"client",organization:null});n(!1)}catch($){console.error("Error processing user data:",$),n(!1)}},{data:{subscription:w}}=R.auth.onAuthStateChange(async(p,y)=>{p==="SIGNED_IN"&&y?(n(!0),await b(y.user.id,y.user.email||"")):p==="SIGNED_OUT"?(s(null),n(!1)):p==="TOKEN_REFRESHED"?(console.log("Token refreshed:",y==null?void 0:y.user.email),y&&await b(y.user.id,y.user.email||"")):p==="INITIAL_SESSION"&&(y?await b(y.user.id,y.user.email||""):n(!1))}),f=async()=>{try{const p=x(),{data:y,error:S}=await R.auth.getSession();if(S){console.error("Error getting session from server:",S),p||n(!1);return}if(!y.session){if(console.log("No active session found on server"),p){console.log("Attempting to refresh token from stored session...");const{data:_,error:A}=await R.auth.refreshSession();if(A||!_.session){console.error("Failed to refresh session:",A),n(!1);return}else{console.log("Successfully refreshed session"),await b(_.session.user.id,_.session.user.email||"");return}}n(!1);return}await b(y.session.user.id,y.session.user.email||"")}catch(p){console.error("Error checking session:",p),n(!1)}},N=setTimeout(()=>{n(!1)},3e3);return f(),()=>{w.unsubscribe(),clearTimeout(N)}},[]);const g={user:t,loading:r,error:i,login:async(x,b)=>{var w;try{n(!0),o(null);const{data:f,error:N}=await R.auth.signInWithPassword({email:x,password:b});if(N){o(N.message),n(!1);return}if(!f.session){o("No session returned"),n(!1);return}const{data:p,error:y}=await R.from("profiles").select("*").eq("id",f.user.id).single();let S="client";const _=(w=f.user.app_metadata)==null?void 0:w.role;p?(_==="superadmin"||p.role==="superadmin"?S="superadmin":(_==="admin"||p.role==="admin")&&(S="admin"),s({id:f.user.id,email:f.user.email||"",name:p.name||"",role:S,organization:p.organization})):s({id:f.user.id,email:f.user.email||"",name:x.split("@")[0],role:_||"client",organization:null}),n(!1)}catch(f){console.error("Login failed:",f),o(f instanceof Error?f.message:"An error occurred during login"),n(!1)}},logout:async()=>{try{await R.auth.signOut(),s(null),l("/login")}catch(x){console.error("Logout error:",x),l("/login")}},signup:async(x,b,w,f,N)=>{n(!0),o(null);const p=window.location.pathname.includes("/admin")||window.location.pathname.includes("/superadmin");try{let y=null;p&&(y=t);const{data:S,error:_}=await R.auth.signUp({email:x,password:b,options:{data:{name:w,role:f,organization:N}}});if(_)throw _;if(S.user){const{error:A}=await R.from("profiles").insert([{id:S.user.id,name:w,role:f,organization:N,email:x}]);if(A&&A.code!=="23505")throw A;if(p&&y)return s(y),n(!1),{success:!0,userId:S.user.id};if(!p){const $={id:S.user.id,email:x,name:w,role:f,organization:N};s($),n(!1),l(f==="admin"?"/admin":"/client")}return n(!1),{success:!0,userId:S.user.id}}}catch(y){return console.error("Signup error:",y),o(y instanceof Error?y.message:"An error occurred during signup"),n(!1),{success:!1,error:y}}},forgotPassword:async x=>{n(!0),o(null);try{const{error:b}=await R.auth.resetPasswordForEmail(x,{redirectTo:`${window.location.origin}/reset-password`});if(b)throw b;l("/login",{state:{message:"Password reset email sent"}})}catch(b){console.error("Password reset error:",b),o(b instanceof Error?b.message:"An error occurred sending password reset")}finally{n(!1)}},resetPassword:async(x,b)=>{n(!0),o(null);try{const{error:w}=await R.auth.updateUser({password:b});if(w)throw w;l("/login",{state:{message:"Password reset successful"}})}catch(w){console.error("Reset password error:",w),o(w instanceof Error?w.message:"An error occurred during password reset")}finally{n(!1)}}};return e.jsx(xs.Provider,{value:g,children:a})},oe=()=>{const a=v.useContext(xs);if(a===void 0)throw new Error("useAuth must be used within an AuthProvider");return a},ta=()=>{const[a,t]=v.useState(""),[s,r]=v.useState(""),{login:n,loading:i,error:o,user:l}=oe(),c=ot();v.useEffect(()=>{l&&(l.role==="superadmin"?c("/superadmin"):l.role==="admin"?c("/admin"):c("/client"))},[l,c]);const h=async d=>{if(d.preventDefault(),!i)try{await n(a,s)}catch(u){console.error("Login error:",u)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(Ne,{className:"h-12 w-12 text-blue-600"})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",e.jsx(V,{to:"/admin/signup",className:"font-medium text-blue-600 hover:text-blue-500",children:"create a new account"})]})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[o&&e.jsx("div",{className:"mb-4 rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ps,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:o})})]})}),e.jsxs("form",{className:"space-y-6",onSubmit:h,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Bs,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:a,onChange:d=>t(d.target.value),className:"focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md",placeholder:"you@example.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Fs,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:s,onChange:d=>r(d.target.value),className:"focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),e.jsx("div",{className:"text-sm",children:e.jsx(V,{to:"/forgot-password",className:"font-medium text-blue-600 hover:text-blue-500",children:"Forgot your password?"})})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:i,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:i?"Signing in...":"Sign in"})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Demo accounts"})})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Super Admin:"}),e.jsx("code",{className:"text-xs bg-gray-100 p-1 rounded",children:"superadmin@example.com / password"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Admin:"}),e.jsx("code",{className:"text-xs bg-gray-100 p-1 rounded",children:"admin@example.com / password"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Client:"}),e.jsx("code",{className:"text-xs bg-gray-100 p-1 rounded",children:"client@example.com / password"})]})]})]})]})})]})},$t=({children:a})=>{const{user:t}=oe(),s=Ce(),[r,n]=v.useState(null);return v.useEffect(()=>{(async()=>{try{if(t)return;const{data:o}=await R.auth.getSession();if(o!=null&&o.session){n(!0);return}n(!1)}catch{n(!1)}})()},[t]),t?e.jsx(e.Fragment,{children:a}):r?e.jsx(e.Fragment,{children:a}):r===!1&&!t?e.jsx(Le,{to:"/login",state:{from:s.pathname},replace:!0}):null},se=({children:a})=>{const{user:t}=oe(),s=Ce(),[r,n]=v.useState(null);return v.useEffect(()=>{(async()=>{var o,l;try{if((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")return;const{data:c}=await R.auth.getSession();if(c!=null&&c.session){const{data:h}=await R.from("profiles").select("role").eq("id",c.session.user.id).single();if((h==null?void 0:h.role)==="admin"||(h==null?void 0:h.role)==="superadmin"||((o=c.session.user.app_metadata)==null?void 0:o.role)==="admin"||((l=c.session.user.app_metadata)==null?void 0:l.role)==="superadmin"){n(!0);return}}n(!1)}catch{n(!1)}})()},[t]),(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin"?e.jsx(e.Fragment,{children:a}):r?e.jsx(e.Fragment,{children:a}):r===!1&&(t==null?void 0:t.role)!=="admin"&&(t==null?void 0:t.role)!=="superadmin"?e.jsx(Le,{to:"/login",state:{from:s.pathname},replace:!0}):null},Re=({children:a})=>{const{user:t}=oe(),s=Ce(),[r,n]=v.useState(null);return v.useEffect(()=>{(async()=>{var o;try{if((t==null?void 0:t.role)==="superadmin")return;const{data:l}=await R.auth.getSession();if(l!=null&&l.session){const{data:c}=await R.from("profiles").select("role").eq("id",l.session.user.id).single();if((c==null?void 0:c.role)==="superadmin"||((o=l.session.user.app_metadata)==null?void 0:o.role)==="superadmin"){n(!0);return}}n(!1)}catch{n(!1)}})()},[t]),(t==null?void 0:t.role)==="superadmin"?e.jsx(e.Fragment,{children:a}):r?e.jsx(e.Fragment,{children:a}):r===!1&&(t==null?void 0:t.role)!=="superadmin"?e.jsx(Le,{to:"/login",state:{from:s.pathname},replace:!0}):null},sa=()=>e.jsxs("div",{className:"bg-white",children:[e.jsx("header",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-16 items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ne,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"ConsentHub"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(V,{to:"/login",className:"text-gray-500 hover:text-gray-700",children:"Login"}),e.jsx(V,{to:"/admin/signup",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:"Sign Up"})]})]})})}),e.jsxs("div",{className:"relative bg-white overflow-hidden",children:[e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"relative z-10 pb-8 bg-white sm:pb-16 md:pb-20 lg:max-w-2xl lg:w-full lg:pb-28 xl:pb-32",children:e.jsx("main",{className:"mt-10 mx-auto max-w-7xl px-4 sm:mt-12 sm:px-6 md:mt-16 lg:mt-20 lg:px-8 xl:mt-28",children:e.jsxs("div",{className:"sm:text-center lg:text-left",children:[e.jsxs("h1",{className:"text-4xl tracking-tight font-extrabold text-gray-900 sm:text-5xl md:text-6xl",children:[e.jsx("span",{className:"block xl:inline",children:"GDPR Compliance"})," ",e.jsx("span",{className:"block text-blue-600 xl:inline",children:"Made Simple"})]}),e.jsx("p",{className:"mt-3 text-base text-gray-500 sm:mt-5 sm:text-lg sm:max-w-xl sm:mx-auto md:mt-5 md:text-xl lg:mx-0",children:"ConsentHub provides a simple, customizable cookie consent solution that helps your website comply with GDPR, CCPA, and other privacy regulations."}),e.jsxs("div",{className:"mt-5 sm:mt-8 sm:flex sm:justify-center lg:justify-start",children:[e.jsx("div",{className:"rounded-md shadow",children:e.jsx(V,{to:"/admin/signup",className:"w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 md:py-4 md:text-lg md:px-10",children:"Get Started"})}),e.jsx("div",{className:"mt-3 sm:mt-0 sm:ml-3",children:e.jsx(V,{to:"/login",className:"w-full flex items-center justify-center px-8 py-3 border border-gray-300 text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 md:py-4 md:text-lg md:px-10",children:"Live Demo"})})]})]})})})}),e.jsx("div",{className:"lg:absolute lg:inset-y-0 lg:right-0 lg:w-1/2 bg-blue-50 flex items-center justify-center",children:e.jsx("div",{className:"h-56 w-full sm:h-72 md:h-96 lg:w-full lg:h-full p-8",children:e.jsx("div",{className:"w-full h-full bg-white rounded-lg shadow-lg p-6 flex items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"bg-blue-600 rounded-t-lg p-4 flex items-center",children:[e.jsx(Ne,{className:"h-6 w-6 text-white"}),e.jsx("span",{className:"ml-2 text-white font-medium",children:"Cookie Consent"})]}),e.jsxs("div",{className:"border border-gray-200 border-t-0 rounded-b-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-700 mb-4",children:'We use cookies to enhance your browsing experience. By clicking "Accept All", you consent to our use of cookies.'}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 text-sm font-medium rounded bg-blue-600 text-white",children:"Accept All"}),e.jsx("button",{className:"px-3 py-1.5 text-sm font-medium rounded border border-blue-600 text-blue-600",children:"Customize"}),e.jsx("button",{className:"px-3 py-1.5 text-sm font-medium rounded border border-gray-300 text-gray-700",children:"Reject All"})]})]})]})})})})]}),e.jsx("div",{className:"py-12 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"lg:text-center",children:[e.jsx("h2",{className:"text-base text-blue-600 font-semibold tracking-wide uppercase",children:"Features"}),e.jsx("p",{className:"mt-2 text-3xl leading-8 font-extrabold tracking-tight text-gray-900 sm:text-4xl",children:"Everything you need for GDPR compliance"}),e.jsx("p",{className:"mt-4 max-w-2xl text-xl text-gray-500 lg:mx-auto",children:"ConsentHub provides all the tools you need to make your website compliant with privacy regulations."})]}),e.jsx("div",{className:"mt-10",children:e.jsxs("div",{className:"space-y-10 md:space-y-0 md:grid md:grid-cols-2 md:gap-x-8 md:gap-y-10",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute flex items-center justify-center h-12 w-12 rounded-md bg-blue-500 text-white",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsxs("div",{className:"ml-16",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Customizable Consent Popups"}),e.jsx("p",{className:"mt-2 text-base text-gray-500",children:"Fully customize the appearance of your consent popup to match your brand identity."})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute flex items-center justify-center h-12 w-12 rounded-md bg-blue-500 text-white",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),e.jsxs("div",{className:"ml-16",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"GDPR & CCPA Compliant"}),e.jsx("p",{className:"mt-2 text-base text-gray-500",children:"Our solution is compliant with GDPR, CCPA, and other privacy regulations worldwide."})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute flex items-center justify-center h-12 w-12 rounded-md bg-blue-500 text-white",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})}),e.jsxs("div",{className:"ml-16",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Easy Integration"}),e.jsx("p",{className:"mt-2 text-base text-gray-500",children:"Simple copy-paste integration with any website or platform in just minutes."})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute flex items-center justify-center h-12 w-12 rounded-md bg-blue-500 text-white",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsxs("div",{className:"ml-16",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Detailed Analytics"}),e.jsx("p",{className:"mt-2 text-base text-gray-500",children:"Track consent rates and user preferences with detailed analytics dashboards."})]})]})]})})]})}),e.jsx("div",{className:"bg-blue-700",children:e.jsxs("div",{className:"max-w-2xl mx-auto text-center py-16 px-4 sm:py-20 sm:px-6 lg:px-8",children:[e.jsxs("h2",{className:"text-3xl font-extrabold text-white sm:text-4xl",children:[e.jsx("span",{className:"block",children:"Ready to get started?"}),e.jsx("span",{className:"block",children:"Sign up for free today."})]}),e.jsx("p",{className:"mt-4 text-lg leading-6 text-blue-200",children:"Start your 14-day free trial. No credit card required."}),e.jsx(V,{to:"/admin/signup",className:"mt-8 w-full inline-flex items-center justify-center px-5 py-3 border border-transparent text-base font-medium rounded-md text-blue-700 bg-white hover:bg-blue-50 sm:w-auto",children:"Sign up for free"})]})}),e.jsx("footer",{className:"bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto py-12 px-4 overflow-hidden sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mt-8 flex justify-center space-x-6",children:[e.jsxs("a",{href:"#",className:"text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"sr-only",children:"Twitter"}),e.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{d:"M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"})})]}),e.jsxs("a",{href:"#",className:"text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"sr-only",children:"GitHub"}),e.jsx("svg",{className:"h-6 w-6",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z",clipRule:"evenodd"})})]})]}),e.jsx("p",{className:"mt-8 text-center text-base text-gray-400",children:"© 2023 ConsentHub. All rights reserved."})]})})]}),B=({children:a,title:t})=>{const[s,r]=v.useState(!1),n=Ce(),i=ot(),{logout:o,user:l,loading:c}=oe();v.useEffect(()=>{!c&&l===null&&i("/login")},[l,c,i]);const h=n.pathname.includes("/superadmin"),d=n.pathname.includes("/admin")&&!h;n.pathname.includes("/client");const u=v.useCallback((x,b)=>{b.preventDefault(),i(x)},[i]),m=x=>{x.preventDefault(),console.log("Logging out from DashboardLayout"),o()},g=h?[{name:"Dashboard",href:"/superadmin",icon:He},{name:"Admin Management",href:"/superadmin/admins",icon:fe},{name:"Global Branding",href:"/superadmin/branding",icon:Oe},{name:"Analytics",href:"/superadmin/analytics",icon:W}]:d?[{name:"Dashboard",href:"/admin",icon:He},{name:"Client Management",href:"/admin/clients",icon:fe},{name:"Branding Settings",href:"/admin/branding",icon:Oe},{name:"Code Generator",href:"/admin/code",icon:me},{name:"Analytics",href:"/admin/analytics",icon:W}]:[{name:"Dashboard",href:"/client",icon:He},{name:"Analytics",href:"/client/analytics",icon:W}];return c?e.jsx("div",{className:"h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 rounded-full border-t-transparent"})}):l?e.jsxs("div",{className:"h-screen flex overflow-hidden bg-gray-100",children:[e.jsxs("div",{className:`md:hidden fixed inset-0 flex z-40 ${s?"block":"hidden"}`,children:[e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75","aria-hidden":"true",onClick:()=>r(!1)}),e.jsxs("div",{className:"relative flex-1 flex flex-col max-w-xs w-full pt-5 pb-4 bg-white",children:[e.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:e.jsxs("button",{type:"button",className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>r(!1),children:[e.jsx("span",{className:"sr-only",children:"Close sidebar"}),e.jsx(ft,{className:"h-6 w-6 text-white"})]})}),e.jsxs("div",{className:"flex-shrink-0 flex items-center px-4",children:[e.jsx(Ne,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"ConsentHub"})]}),e.jsx("div",{className:"mt-5 flex-1 h-0 overflow-y-auto",children:e.jsx("nav",{className:"px-2 space-y-1",children:g.map(x=>{const b=x.icon,w=n.pathname===x.href;return e.jsxs("a",{href:x.href,onClick:f=>u(x.href,f),className:`group flex items-center px-2 py-2 w-full text-left text-base font-medium rounded-md ${w?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[e.jsx(b,{className:`mr-4 h-6 w-6 ${w?"text-blue-600":"text-gray-400 group-hover:text-gray-500"}`}),x.name]},x.name)})})})]})]}),e.jsx("div",{className:"hidden md:flex md:flex-shrink-0",children:e.jsx("div",{className:"flex flex-col w-64",children:e.jsxs("div",{className:"flex flex-col h-0 flex-1",children:[e.jsxs("div",{className:"flex items-center h-16 flex-shrink-0 px-4 bg-white border-b border-gray-200",children:[e.jsx(Ne,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"ConsentHub"})]}),e.jsx("div",{className:"flex-1 flex flex-col overflow-y-auto",children:e.jsx("nav",{className:"flex-1 px-2 py-4 bg-white space-y-1",children:g.map(x=>{const b=x.icon,w=n.pathname===x.href;return e.jsxs("a",{href:x.href,onClick:f=>u(x.href,f),className:`group flex items-center px-2 py-2 w-full text-left text-sm font-medium rounded-md ${w?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[e.jsx(b,{className:`mr-3 h-6 w-6 ${w?"text-blue-600":"text-gray-400 group-hover:text-gray-500"}`}),x.name]},x.name)})})})]})})}),e.jsxs("div",{className:"flex flex-col w-0 flex-1 overflow-hidden",children:[e.jsxs("div",{className:"relative z-10 flex-shrink-0 flex h-16 bg-white shadow",children:[e.jsxs("button",{type:"button",className:"px-4 border-r border-gray-200 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500 md:hidden",onClick:()=>r(!0),children:[e.jsx("span",{className:"sr-only",children:"Open sidebar"}),e.jsx(Ms,{className:"h-6 w-6"})]}),e.jsxs("div",{className:"flex-1 px-4 flex justify-between",children:[e.jsx("div",{className:"flex-1 flex items-center",children:e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:t})}),e.jsxs("div",{className:"ml-4 flex items-center md:ml-6",children:[e.jsxs("button",{type:"button",className:"bg-white p-1 rounded-full text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx("span",{className:"sr-only",children:"View notifications"}),e.jsx($s,{className:"h-6 w-6"})]}),e.jsx("div",{className:"ml-3 relative flex items-center",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2",children:e.jsxs("button",{type:"button",className:"max-w-xs bg-white flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",id:"user-menu","aria-expanded":"false","aria-haspopup":"true",children:[e.jsx("span",{className:"sr-only",children:"Open user menu"}),e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(zs,{className:"h-5 w-5 text-gray-500"})})]})}),e.jsxs("button",{onClick:x=>m(x),className:"ml-2 inline-flex items-center px-3 py-1 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[e.jsx(Us,{className:"h-4 w-4 mr-1"}),"Logout"]})]})})]})]})]}),e.jsx("main",{className:"flex-1 relative overflow-y-auto focus:outline-none",children:e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8",children:a})})})]})]}):null},ra=()=>{const a=Ce();return v.useEffect(()=>{console.log("AdminDashboard mounted, checking localStorage");const t=localStorage.getItem("user");console.log("User in localStorage:",t?JSON.parse(t):"No user found")},[a.pathname]),e.jsxs(B,{title:"Dashboard",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(fe,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Clients"}),e.jsx("dd",{children:e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"12"})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"/admin/clients",className:"font-medium text-blue-600 hover:text-blue-500",children:"View all"})})})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(me,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Scripts"}),e.jsx("dd",{children:e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"8"})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"/admin/code",className:"font-medium text-blue-600 hover:text-blue-500",children:"Generate code"})})})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(W,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Consents"}),e.jsx("dd",{children:e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"245K"})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"/admin/analytics",className:"font-medium text-blue-600 hover:text-blue-500",children:"View analytics"})})})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-lg leading-6 font-medium text-gray-900",children:"Recent Activity"}),e.jsx("div",{className:"mt-2 bg-white shadow overflow-hidden sm:rounded-md",children:e.jsxs("ul",{className:"divide-y divide-gray-200",children:[e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 truncate",children:"New client added"}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"New"})})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsx("div",{className:"sm:flex",children:e.jsxs("p",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(fe,{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400"}),"Example Client"]})}),e.jsx("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:e.jsx("p",{children:"Just now"})})]})]})}),e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 truncate",children:"Script generated"}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:"Generated"})})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsx("div",{className:"sm:flex",children:e.jsxs("p",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(me,{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400"}),"example-client.com"]})}),e.jsx("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:e.jsx("p",{children:"2 hours ago"})})]})]})}),e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 truncate",children:"Consent rate decreased"}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:"Alert"})})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsx("div",{className:"sm:flex",children:e.jsxs("p",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Rs,{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-red-500"}),"-1.2% from last week"]})}),e.jsx("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:e.jsx("p",{children:"1 day ago"})})]})]})})]})})]})]})},C={primaryColor:"#3B82F6",secondaryColor:"#1E40AF",accentColor:"#60A5FA",textColor:"#1F2937",backgroundColor:"#F9FAFB"},na=[{id:"bottom",name:"Bottom"},{id:"top",name:"Top"},{id:"bottom-left",name:"Bottom Left"},{id:"bottom-right",name:"Bottom Right"},{id:"top-left",name:"Top Left"},{id:"top-right",name:"Top Right"}],aa=[{id:"light",name:"Light"},{id:"dark",name:"Dark"},{id:"minimal",name:"Minimal"},{id:"colorful",name:"Colorful"}],gs=({position:a,theme:t,primaryColor:s,secondaryColor:r,accentColor:n,textColor:i,backgroundColor:o,logo:l,companyName:c,onAcceptAll:h,onRejectAll:d,onSavePreferences:u})=>{const g=(()=>{switch(a){case"top":return"top-0 left-0 right-0";case"center":return"top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 max-w-lg";case"bottom-right":return"bottom-4 right-4 max-w-sm";case"bottom-left":return"bottom-4 left-4 max-w-sm";case"bottom":default:return"bottom-0 left-0 right-0"}})(),x={container:{backgroundColor:o,color:i},header:{backgroundColor:s,color:"#ffffff"},primaryButton:{backgroundColor:r,color:"#ffffff"},secondaryButton:{backgroundColor:"transparent",color:n,border:`1px solid ${n}`},tertiaryButton:{backgroundColor:"transparent",color:i,border:`1px solid ${i}`,opacity:.7}};return e.jsx("div",{className:`fixed ${g} z-50 overflow-hidden rounded-lg shadow-xl`,style:x.container,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"px-4 py-3 flex items-center",style:x.header,children:[l&&e.jsx("img",{src:l,alt:`${c} logo`,className:"h-6 mr-2"}),e.jsx("span",{className:"font-medium text-white",children:c||"Cookie Consent"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"We value your privacy"}),e.jsx("p",{className:"text-sm mb-4",children:'We use cookies to enhance your browsing experience, serve personalized ads or content, and analyze our traffic. By clicking "Accept All", you consent to our use of cookies.'}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",id:"necessary",checked:!0,disabled:!0,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"necessary",className:"ml-2 block text-sm",children:"Necessary (Required)"})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",id:"preferences",className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"preferences",className:"ml-2 block text-sm",children:"Preferences"})]}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",id:"statistics",className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"statistics",className:"ml-2 block text-sm",children:"Statistics"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"marketing",className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"marketing",className:"ml-2 block text-sm",children:"Marketing"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:h,className:"px-4 py-2 text-sm font-medium rounded-md",style:x.primaryButton,children:"Accept All"}),e.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium rounded-md",style:x.secondaryButton,children:"Save Preferences"}),e.jsx("button",{onClick:d,className:"px-4 py-2 text-sm font-medium rounded-md",style:x.tertiaryButton,children:"Reject All"})]})]})]})})},ia=()=>{const[a,t]=v.useState(()=>{const g=localStorage.getItem("adminBranding");if(g)try{return{...JSON.parse(g),logo:null}}catch(x){console.error("Error parsing saved branding:",x)}return{primaryColor:C.primaryColor,secondaryColor:C.secondaryColor,accentColor:C.accentColor,textColor:C.textColor,backgroundColor:C.backgroundColor,logo:null,logoPreview:"",position:"bottom",theme:"light"}}),[s,r]=v.useState(!1),[n,i]=v.useState(!1),[o,l]=v.useState(!1);v.useEffect(()=>(document.documentElement.style.setProperty("--primary-color",a.primaryColor),document.documentElement.style.setProperty("--secondary-color",a.secondaryColor),console.log("Branding settings loaded:",a),()=>{}),[]);const c=g=>{const{name:x,value:b}=g.target;t({...a,[x]:b})},h=g=>{const{name:x,value:b}=g.target;t({...a,[x]:b})},d=g=>{if(g.target.files&&g.target.files[0]){const x=g.target.files[0];t({...a,logo:x,logoPreview:URL.createObjectURL(x)})}},u=()=>{const g={primaryColor:C.primaryColor,secondaryColor:C.secondaryColor,accentColor:C.accentColor,textColor:C.textColor,backgroundColor:C.backgroundColor,logo:null,logoPreview:"",position:"bottom",theme:"light"};t(g),localStorage.removeItem("adminBranding"),console.log("Branding settings reset to defaults"),l(!0),setTimeout(()=>l(!1),3e3)},m=()=>{i(!0);try{const g={...a};delete g.logo,localStorage.setItem("adminBranding",JSON.stringify(g)),console.log("Branding settings saved to localStorage:",g),document.documentElement.style.setProperty("--primary-color",a.primaryColor),document.documentElement.style.setProperty("--secondary-color",a.secondaryColor),i(!1),l(!0),setTimeout(()=>l(!1),3e3)}catch(g){console.error("Error saving branding settings:",g),alert("Failed to save branding settings. Please try again."),i(!1)}};return e.jsxs(B,{title:"Branding Settings",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Customize Your Consent Popup"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logo"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-16 w-16 bg-gray-100 rounded-md overflow-hidden flex items-center justify-center",children:a.logoPreview?e.jsx("img",{src:a.logoPreview,alt:"Logo preview",className:"h-full w-full object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No logo"})}),e.jsxs("div",{className:"ml-5",children:[e.jsxs("div",{className:"relative bg-white rounded-md shadow-sm",children:[e.jsx("input",{type:"file",id:"logo",name:"logo",accept:"image/*",onChange:d,className:"sr-only"}),e.jsx("label",{htmlFor:"logo",className:"cursor-pointer py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Choose file"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"PNG, JPG, GIF up to 2MB"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"position",className:"block text-sm font-medium text-gray-700 mb-1",children:"Position"}),e.jsxs("select",{id:"position",name:"position",value:a.position,onChange:h,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"bottom",children:"Bottom Banner"}),e.jsx("option",{value:"top",children:"Top Banner"}),e.jsx("option",{value:"center",children:"Center Modal"}),e.jsx("option",{value:"bottom-right",children:"Bottom Right"}),e.jsx("option",{value:"bottom-left",children:"Bottom Left"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"theme",className:"block text-sm font-medium text-gray-700 mb-1",children:"Theme"}),e.jsxs("select",{id:"theme",name:"theme",value:a.theme,onChange:h,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"}),e.jsx("option",{value:"minimal",children:"Minimal"}),e.jsx("option",{value:"colorful",children:"Colorful"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"primaryColor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Color"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"color",id:"primaryColor",name:"primaryColor",value:a.primaryColor,onChange:c,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:a.primaryColor,onChange:c,name:"primaryColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"secondaryColor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Secondary Color"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"color",id:"secondaryColor",name:"secondaryColor",value:a.secondaryColor,onChange:c,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:a.secondaryColor,onChange:c,name:"secondaryColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"accentColor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Accent Color"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"color",id:"accentColor",name:"accentColor",value:a.accentColor,onChange:c,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:a.accentColor,onChange:c,name:"accentColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"textColor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Text Color"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"color",id:"textColor",name:"textColor",value:a.textColor,onChange:c,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:a.textColor,onChange:c,name:"textColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"backgroundColor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Background Color"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"color",id:"backgroundColor",name:"backgroundColor",value:a.backgroundColor,onChange:c,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:a.backgroundColor,onChange:c,name:"backgroundColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]})]}),e.jsxs("div",{className:"flex justify-between space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>r(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Preview"}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{type:"button",onClick:u,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(qt,{className:"h-4 w-4 mr-2"}),"Reset to Default"]}),e.jsxs("button",{type:"button",onClick:m,disabled:n,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),n?"Saving...":o?"Saved!":"Save Changes"]})]})]})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Preview"}),e.jsxs("div",{className:"border rounded-lg overflow-hidden",style:{backgroundColor:a.backgroundColor},children:[e.jsxs("div",{className:"p-3 flex items-center",style:{backgroundColor:a.primaryColor},children:[a.logoPreview&&e.jsx("img",{src:a.logoPreview,alt:"Logo",className:"h-6 mr-2"}),e.jsx("span",{className:"font-medium text-white",children:"ConsentHub"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",style:{color:a.textColor},children:"Cookie Consent"}),e.jsx("p",{className:"text-xs mb-3",style:{color:a.textColor},children:'We use cookies to enhance your experience on our website. By clicking "Accept All", you consent to the use of all cookies.'}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:"text-xs px-3 py-1 rounded-md",style:{backgroundColor:a.secondaryColor,color:"white"},children:"Accept All"}),e.jsx("button",{className:"text-xs px-3 py-1 rounded-md",style:{backgroundColor:"transparent",color:a.accentColor,border:`1px solid ${a.accentColor}`},children:"Customize"}),e.jsx("button",{className:"text-xs px-3 py-1 rounded-md",style:{backgroundColor:"transparent",color:a.textColor,border:`1px solid ${a.textColor}`,opacity:.7},children:"Reject All"})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Branding Presets"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",className:"p-3 border rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>{t({...a,primaryColor:"#3B82F6",secondaryColor:"#1E40AF",accentColor:"#60A5FA",textColor:"#1F2937",backgroundColor:"#F9FAFB"})},children:[e.jsxs("div",{className:"flex space-x-1 mb-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-500"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-800"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-400"})]}),e.jsx("span",{className:"text-xs text-gray-700",children:"Blue Theme"})]}),e.jsxs("button",{type:"button",className:"p-3 border rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>{t({...a,primaryColor:"#10B981",secondaryColor:"#065F46",accentColor:"#34D399",textColor:"#1F2937",backgroundColor:"#F9FAFB"})},children:[e.jsxs("div",{className:"flex space-x-1 mb-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-green-500"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-green-800"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-green-400"})]}),e.jsx("span",{className:"text-xs text-gray-700",children:"Green Theme"})]}),e.jsxs("button",{type:"button",className:"p-3 border rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>{t({...a,primaryColor:"#8B5CF6",secondaryColor:"#5B21B6",accentColor:"#A78BFA",textColor:"#1F2937",backgroundColor:"#F9FAFB"})},children:[e.jsxs("div",{className:"flex space-x-1 mb-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-purple-500"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-purple-800"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-purple-400"})]}),e.jsx("span",{className:"text-xs text-gray-700",children:"Purple Theme"})]}),e.jsxs("button",{type:"button",className:"p-3 border rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>{t({...a,primaryColor:"#111827",secondaryColor:"#374151",accentColor:"#6B7280",textColor:"#F9FAFB",backgroundColor:"#1F2937"})},children:[e.jsxs("div",{className:"flex space-x-1 mb-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-900"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-700"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-500"})]}),e.jsx("span",{className:"text-xs text-gray-700",children:"Dark Theme"})]})]})]})]})})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg max-w-4xl w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Preview"}),e.jsxs("button",{type:"button",onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx(X,{className:"h-6 w-6"})]})]}),e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg h-96 overflow-auto relative",children:[e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-gray-500",children:"This is your website content"})}),e.jsx(gs,{position:a.position,theme:a.theme,primaryColor:a.primaryColor,secondaryColor:a.secondaryColor,accentColor:a.accentColor,textColor:a.textColor,backgroundColor:a.backgroundColor,logo:a.logoPreview,companyName:"Your Company",onAcceptAll:()=>{},onRejectAll:()=>{},onSavePreferences:()=>{}})]})]})})]})},oa=()=>{const[a,t]=v.useState(""),[s,r]=v.useState(!1),[n,i]=v.useState(!1),[o,l]=v.useState(null),h=[{id:"1",name:"Acme Corporation",website:"acme.com",status:"active",consentRate:87,createdAt:"2023-05-12"},{id:"2",name:"Globex Industries",website:"globex.com",status:"active",consentRate:92,createdAt:"2023-05-10"},{id:"3",name:"Soylent Corp",website:"soylent.com",status:"inactive",consentRate:65,createdAt:"2023-05-08"},{id:"4",name:"Initech",website:"initech.com",status:"active",consentRate:78,createdAt:"2023-05-05"},{id:"5",name:"Umbrella Corporation",website:"umbrella.com",status:"active",consentRate:81,createdAt:"2023-05-03"},{id:"6",name:"Stark Industries",website:"stark.com",status:"inactive",consentRate:73,createdAt:"2023-05-01"}].filter(m=>m.name.toLowerCase().includes(a.toLowerCase())||m.website.toLowerCase().includes(a.toLowerCase())),d=()=>{r(!1)},u=()=>{i(!1),l(null)};return e.jsxs(B,{title:"Client Management",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"relative rounded-md shadow-sm max-w-xs w-full",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(zt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Search clients...",value:a,onChange:m=>t(m.target.value)}),a&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("button",{type:"button",onClick:()=>t(""),className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:e.jsx(ft,{className:"h-4 w-4"})})})]}),e.jsxs("button",{type:"button",onClick:()=>r(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(Mt,{className:"h-5 w-5 mr-2"}),"Add Client"]})]}),e.jsx("div",{className:"border-t border-gray-200",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Website"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Consent Rate"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[h.map(m=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:m.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:m.website}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:m.status==="active"?"Active":"Inactive"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[m.consentRate,"%"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:m.createdAt}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx(V,{to:`/admin/code/${m.id}`,className:"text-blue-600 hover:text-blue-900 mr-3",onClick:g=>{g.preventDefault(),window.location.href=`/admin/code/${m.id}`},children:e.jsx(me,{className:"h-5 w-5"})}),e.jsx(V,{to:`/admin/client/${m.id}`,className:"text-blue-600 hover:text-blue-900 mr-3",onClick:g=>{g.preventDefault(),window.location.href=`/admin/client/${m.id}`},children:e.jsx(Bt,{className:"h-5 w-5"})}),e.jsx("button",{type:"button",className:"text-red-600 hover:text-red-900",onClick:()=>{l(m),i(!0)},children:e.jsx($e,{className:"h-5 w-5"})})]})]},m.id)),h.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No clients found matching your search criteria."})})]})]})})})]}),s&&e.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:"Add New Client"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Client Name"}),e.jsx("input",{type:"text",name:"name",id:"name",className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"website",className:"block text-sm font-medium text-gray-700",children:"Website"}),e.jsx("input",{type:"text",name:"website",id:"website",className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"status",name:"status",className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:d,children:"Add Client"}),e.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>r(!1),children:"Cancel"})]})]})]})}),n&&o&&e.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx($e,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:"Delete Client"}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete ",o.name,"? This action cannot be undone."]})})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:u,children:"Delete"}),e.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>{i(!1),l(null)},children:"Cancel"})]})]})]})})]})},la=({clientId:a,domain:t,primaryColor:s,secondaryColor:r,accentColor:n,textColor:i,backgroundColor:o,position:l,theme:c,logo:h})=>{const d={primaryColor:s,secondaryColor:r,accentColor:n,textColor:i,backgroundColor:o,position:l,theme:c,logo:h},u=`
<script>
  (function() {
    // ConsentHub Script
    var ch = document.createElement('script');
    ch.type = 'text/javascript';
    ch.async = true;
    ch.src = 'https://cdn.consenthub.com/loader.js';
    ch.setAttribute('data-client-id', '${a}');
    ch.setAttribute('data-domain', '${t}');
    
    // Branding settings
    ch.setAttribute('data-primary-color', '${d.primaryColor}');
    ch.setAttribute('data-secondary-color', '${d.secondaryColor}');
    ch.setAttribute('data-accent-color', '${d.accentColor}');
    ch.setAttribute('data-text-color', '${d.textColor}');
    ch.setAttribute('data-background-color', '${d.backgroundColor}');
    ch.setAttribute('data-position', '${d.position}');
    ch.setAttribute('data-theme', '${d.theme}');
    ${d.logo?`ch.setAttribute('data-logo', '${d.logo}');`:""}
    
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ch, s);
  })();
<\/script>
  `;return e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 text-white font-mono text-sm overflow-auto",children:e.jsx("pre",{children:u})})},It=()=>{const{clientId:a}=Lt(),[t,s]=v.useState(!1),[r,n]=v.useState(!1),i={id:a||"client123",name:"Example Client",domain:"example.com",settings:{position:"bottom",theme:"light",...C}},[o,l]=v.useState({position:"bottom",theme:"light",primaryColor:C.primaryColor,secondaryColor:C.secondaryColor,accentColor:C.accentColor,textColor:C.textColor,backgroundColor:C.backgroundColor}),c=()=>{const d=document.getElementById("consent-script");if(d){const u=d.textContent||"";navigator.clipboard.writeText(u),s(!0),setTimeout(()=>s(!1),2e3)}},h=d=>{const{name:u,value:m}=d.target;l(g=>({...g,[u]:m}))};return e.jsxs(B,{title:"Code Generator",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"JavaScript Code Snippet"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{type:"button",onClick:()=>n(!r),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(Ds,{className:"h-4 w-4 mr-1"}),r?"Hide Preview":"Show Preview"]}),e.jsx("button",{type:"button",onClick:c,className:"inline-flex items-center px-3 py-1.5 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Is,{className:"h-4 w-4 mr-1"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ls,{className:"h-4 w-4 mr-1"}),"Copy Code"]})})]})]})}),e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Add this code snippet to your website's ",e.jsx("code",{children:"<head>"})," section to implement the consent popup."]}),e.jsx("div",{id:"consent-script",className:"relative",children:e.jsx(la,{clientId:i.id,domain:i.domain,position:o.position||"bottom",theme:o.theme||"light",primaryColor:o.primaryColor||"#3B82F6",secondaryColor:o.secondaryColor||"#1E40AF",accentColor:o.accentColor||"#60A5FA",textColor:o.textColor||"#1F2937",backgroundColor:o.backgroundColor||"#F9FAFB"})}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Installation Instructions"}),e.jsx("div",{className:"bg-gray-50 rounded-md p-4",children:e.jsxs("ol",{className:"list-decimal list-inside text-sm text-gray-600 space-y-2",children:[e.jsx("li",{children:"Copy the code snippet above."}),e.jsxs("li",{children:["Paste it into the ",e.jsx("code",{children:"<head>"})," section of your website's HTML."]}),e.jsx("li",{children:"The consent popup will automatically appear to visitors who haven't provided consent yet."}),e.jsx("li",{children:"You can customize the appearance and behavior of the popup using the settings panel."})]})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Platform-specific Instructions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-1",children:"WordPress"}),e.jsx("p",{className:"text-xs text-gray-600",children:`Add the code to your theme's header.php file or use a plugin like "Insert Headers and Footers".`})]}),e.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-1",children:"Shopify"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Go to Online Store > Themes > Edit HTML/CSS > theme.liquid and add the code just before the closing </head> tag."})]}),e.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-1",children:"Wix"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Go to Settings > Advanced > Custom Code and add the code to the Head section."})]}),e.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 mb-1",children:"Squarespace"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Go to Settings > Advanced > Code Injection and add the code to the Header section."})]})]})]})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Customize Settings"})}),e.jsxs("div",{className:"px-4 py-5 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"position",className:"block text-sm font-medium text-gray-700",children:"Position"}),e.jsx("select",{id:"position",name:"position",value:o.position,onChange:h,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:na.map(d=>e.jsx("option",{value:d.id,children:d.name},d.id))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"theme",className:"block text-sm font-medium text-gray-700",children:"Theme"}),e.jsx("select",{id:"theme",name:"theme",value:o.theme,onChange:h,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:aa.map(d=>e.jsx("option",{value:d.id,children:d.name},d.id))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"primaryColor",className:"block text-sm font-medium text-gray-700",children:"Primary Color"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx("input",{type:"color",id:"primaryColor",name:"primaryColor",value:o.primaryColor,onChange:h,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:o.primaryColor,onChange:h,name:"primaryColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"secondaryColor",className:"block text-sm font-medium text-gray-700",children:"Secondary Color"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx("input",{type:"color",id:"secondaryColor",name:"secondaryColor",value:o.secondaryColor,onChange:h,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:o.secondaryColor,onChange:h,name:"secondaryColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"accentColor",className:"block text-sm font-medium text-gray-700",children:"Accent Color"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx("input",{type:"color",id:"accentColor",name:"accentColor",value:o.accentColor,onChange:h,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:o.accentColor,onChange:h,name:"accentColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"textColor",className:"block text-sm font-medium text-gray-700",children:"Text Color"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx("input",{type:"color",id:"textColor",name:"textColor",value:o.textColor,onChange:h,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:o.textColor,onChange:h,name:"textColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"backgroundColor",className:"block text-sm font-medium text-gray-700",children:"Background Color"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx("input",{type:"color",id:"backgroundColor",name:"backgroundColor",value:o.backgroundColor,onChange:h,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:o.backgroundColor,onChange:h,name:"backgroundColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{type:"button",className:"w-full inline-flex justify-center items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Update Code"]})})]})]})})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg max-w-4xl w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Preview"}),e.jsxs("button",{type:"button",onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx(X,{className:"h-6 w-6"})]})]}),e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg h-96 overflow-auto relative",children:[e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-gray-500",children:"This is your website content"})}),e.jsx(gs,{position:o.position||"bottom",theme:o.theme||"light",primaryColor:o.primaryColor||"#3B82F6",secondaryColor:o.secondaryColor||"#1E40AF",accentColor:o.accentColor||"#60A5FA",textColor:o.textColor||"#1F2937",backgroundColor:o.backgroundColor||"#F9FAFB",companyName:i.name,onAcceptAll:()=>{},onRejectAll:()=>{},onSavePreferences:()=>{}})]})]})})]})},ca=()=>{const[a,t]=v.useState("last30"),[s,r]=v.useState("all"),n=[{name:"Total Impressions",value:"450K",change:"+8%",trend:"up"},{name:"Consent Rate",value:"84%",change:"+3%",trend:"up"},{name:"Rejection Rate",value:"11%",change:"-1%",trend:"down"},{name:"Customized Consents",value:"5%",change:"+2%",trend:"up"}],i=[{id:"client1",name:"Acme Corporation"},{id:"client2",name:"Globex Industries"},{id:"client3",name:"Soylent Corp"},{id:"client4",name:"Initech"},{id:"client5",name:"Umbrella Corporation"}],o=c=>{t(c.target.value)},l=c=>{r(c.target.value)};return e.jsx(B,{title:"Analytics",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx("div",{className:"bg-white shadow rounded-lg p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(dt,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"w-full sm:w-48",children:[e.jsx("label",{htmlFor:"clientSelect",className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),e.jsxs("select",{id:"clientSelect",name:"clientSelect",value:s,onChange:l,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"all",children:"All Clients"}),i.map(c=>e.jsx("option",{value:c.id,children:c.name},c.id))]})]}),e.jsxs("div",{className:"w-full sm:w-48",children:[e.jsx("label",{htmlFor:"dateRange",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Range"}),e.jsxs("select",{id:"dateRange",name:"dateRange",value:a,onChange:o,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"yesterday",children:"Yesterday"}),e.jsx("option",{value:"last7",children:"Last 7 days"}),e.jsx("option",{value:"last30",children:"Last 30 days"}),e.jsx("option",{value:"thisMonth",children:"This month"}),e.jsx("option",{value:"lastMonth",children:"Last month"}),e.jsx("option",{value:"custom",children:"Custom range"})]})]}),e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx("label",{htmlFor:"exportData",className:"block text-sm font-medium text-gray-700 mb-1",children:"Export Data"}),e.jsxs("button",{type:"button",className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 w-full sm:w-auto",children:[e.jsx(ct,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:n.map(c=>e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:c.name.includes("Impressions")?e.jsx(W,{className:"h-6 w-6 text-blue-600"}):c.name.includes("Consent")?e.jsx(ht,{className:"h-6 w-6 text-green-600"}):c.name.includes("Rejection")?e.jsx(mt,{className:"h-6 w-6 text-red-600"}):e.jsx(lt,{className:"h-6 w-6 text-purple-600"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:c.name}),e.jsxs("dd",{className:"flex items-baseline",children:[e.jsx("div",{className:"text-lg font-medium text-gray-900",children:c.value}),e.jsx("div",{className:`ml-2 flex items-center text-sm font-semibold ${c.trend==="up"?"text-green-600":"text-red-600"}`,children:c.change})]})]})})]})})},c.name))}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Consent Rate Trends"}),e.jsx("div",{className:"h-80 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Consent rate trend chart will be displayed here"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Consent by Category"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Consent category chart will be displayed here"})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Consent by Country"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Geographical consent chart will be displayed here"})})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Client Performance Comparison"}),e.jsx("div",{className:"h-80 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Client comparison chart will be displayed here"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Device Breakdown"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Device analytics chart will be displayed here"})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Browser Breakdown"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Browser analytics chart will be displayed here"})})]})]})]})})},da=()=>{const{clientId:a}=Lt(),[t,s]=v.useState(!0),[r,n]=v.useState({id:"",name:"",website:"",status:"active",email:"",phone:"",address:"",notes:""});v.useEffect(()=>{setTimeout(()=>{n({id:a||"0",name:"Example Client",website:"example.com",status:"active",email:"contact@example.com",phone:"(555) 123-4567",address:"123 Main St, Anytown, US 12345",notes:"This client was added for demonstration purposes."}),s(!1)},500)},[a]);const i=c=>{const{name:h,value:d}=c.target;n(u=>({...u,[h]:d}))},o=c=>{c.preventDefault(),console.log("Updating client:",r),alert("Client updated successfully!")},l=()=>{window.location.href="/admin/clients"};return t?e.jsx(B,{title:"Edit Client",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):e.jsxs(B,{title:"Edit Client",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{type:"button",onClick:l,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(Os,{className:"h-5 w-5 mr-2"}),"Back to Clients"]})}),e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Client Information"}),e.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Edit client details and settings."})]}),e.jsxs("form",{onSubmit:o,className:"px-4 py-5 sm:p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Client Name"}),e.jsx("input",{type:"text",name:"name",id:"name",value:r.name,onChange:i,className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"website",className:"block text-sm font-medium text-gray-700",children:"Website"}),e.jsx("input",{type:"text",name:"website",id:"website",value:r.website,onChange:i,className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",id:"email",value:r.email,onChange:i,className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone"}),e.jsx("input",{type:"text",name:"phone",id:"phone",value:r.phone,onChange:i,className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"status",name:"status",value:r.status,onChange:i,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsx("input",{type:"text",name:"address",id:"address",value:r.address,onChange:i,className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes"}),e.jsx("textarea",{id:"notes",name:"notes",rows:4,value:r.notes,onChange:i,className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border border-gray-300 rounded-md"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{type:"submit",className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(ut,{className:"h-5 w-5 mr-2"}),"Save Changes"]})})]})]})]})},ha=()=>e.jsxs(B,{title:"Dashboard",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(fe,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Admins"}),e.jsx("dd",{children:e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"24"})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"/superadmin/admins",className:"font-medium text-blue-600 hover:text-blue-500",children:"View all"})})})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Oe,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Clients"}),e.jsx("dd",{children:e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"142"})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"/superadmin/clients",className:"font-medium text-blue-600 hover:text-blue-500",children:"View all"})})})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(W,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Consents"}),e.jsx("dd",{children:e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"1.2M"})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"/superadmin/analytics",className:"font-medium text-blue-600 hover:text-blue-500",children:"View analytics"})})})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-lg leading-6 font-medium text-gray-900",children:"Recent Activity"}),e.jsx("div",{className:"mt-2 bg-white shadow overflow-hidden sm:rounded-md",children:e.jsxs("ul",{className:"divide-y divide-gray-200",children:[e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 truncate",children:"New admin registered"}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"New"})})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsx("div",{className:"sm:flex",children:e.jsxs("p",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(fe,{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400"}),"Acme Corp"]})}),e.jsx("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:e.jsx("p",{children:"Just now"})})]})]})}),e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 truncate",children:"Global branding updated"}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:"Update"})})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsx("div",{className:"sm:flex",children:e.jsxs("p",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Oe,{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400"}),"System"]})}),e.jsx("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:e.jsx("p",{children:"2 hours ago"})})]})]})}),e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 truncate",children:"Consent rate increased"}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Improved"})})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsx("div",{className:"sm:flex",children:e.jsxs("p",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Ut,{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-green-500"}),"+2.5% from last week"]})}),e.jsx("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:e.jsx("p",{children:"1 day ago"})})]})]})})]})})]})]}),ua=()=>{const{signup:a}=oe(),[t,s]=v.useState(""),[r,n]=v.useState(!1),[i,o]=v.useState(!1),[l,c]=v.useState(!1),[h,d]=v.useState(null),[u,m]=v.useState([]),[g,x]=v.useState(!0),[b,w]=v.useState(null),[f,N]=v.useState({name:"",email:"",company:"",password:""}),[p,y]=v.useState({name:"",email:"",company:""});v.useEffect(()=>{(async()=>{try{x(!0);const{data:z,error:ee}=await R.from("profiles").select("*").eq("role","admin");if(ee)throw ee;const Ge=z.map(M=>({id:M.id,name:M.name||"",email:M.email||"",company:M.organization||"",clients:0,status:"active",joinedDate:new Date(M.created_at).toISOString().split("T")[0]}));m(Ge)}catch(z){console.error("Error fetching admins:",z),w("Failed to load admin accounts")}finally{x(!1)}})()},[]);const S=u.filter(j=>j.name.toLowerCase().includes(t.toLowerCase())||j.email.toLowerCase().includes(t.toLowerCase())||j.company.toLowerCase().includes(t.toLowerCase())),_=async()=>{try{if(!f.name||!f.email||!f.password){w("Please fill in all required fields");return}x(!0);const j=await a(f.email,f.password,f.name,"admin",f.company);if(console.log("Admin creation result:",j),!j||!j.success)throw new Error((j==null?void 0:j.error)||"Failed to create admin account");const{data:z,error:ee}=await R.from("profiles").select("*").eq("role","admin");if(ee)throw ee;const Ge=z.map(M=>({id:M.id,name:M.name||"",email:M.email||"",company:M.organization||"",clients:0,status:"active",joinedDate:M.created_at?new Date(M.created_at).toISOString().split("T")[0]:"(unknown)"}));m(Ge),N({name:"",email:"",company:"",password:""}),n(!1),w(null),x(!1)}catch(j){console.error("Error adding admin:",j),w("Failed to create admin account: "+(j instanceof Error?j.message:String(j))),x(!1)}},A=()=>{o(!1),d(null)},$=()=>{console.log("Updating admin:",h==null?void 0:h.id,p),c(!1),d(null)},L=j=>{d(j),y({name:j.name,email:j.email,company:j.company}),c(!0)};return e.jsxs(B,{title:"Admin Management",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[b&&!r&&e.jsx("div",{className:"bg-red-50 p-4 rounded-t-lg",children:e.jsx("p",{className:"text-sm text-red-800",children:b})}),e.jsxs("div",{className:"px-4 py-5 sm:px-6 flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"relative rounded-md shadow-sm max-w-xs w-full",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(zt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Search admins...",value:t,onChange:j=>s(j.target.value)}),t&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("button",{type:"button",onClick:()=>s(""),className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:e.jsx(ft,{className:"h-4 w-4"})})})]}),e.jsxs("button",{type:"button",onClick:()=>n(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(Mt,{className:"h-5 w-5 mr-2"}),"Add Admin"]})]}),e.jsx("div",{className:"border-t border-gray-200",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clients"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Loading admin accounts..."})}):e.jsxs(e.Fragment,{children:[S.map(j=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:j.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.company}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.clients}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${j.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:j.status==="active"?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.joinedDate}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-900 mr-3",onClick:()=>L(j),children:e.jsx(Bt,{className:"h-5 w-5"})}),e.jsx("button",{type:"button",className:"text-red-600 hover:text-red-900",onClick:()=>{d(j),o(!0)},children:e.jsx($e,{className:"h-5 w-5"})})]})]},j.id)),S.length===0&&!g&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-sm text-gray-500",children:t?"No admins found matching your search criteria.":'No admin accounts found. Add your first admin using the "Add Admin" button.'})})]})})]})})})]}),r&&e.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:"Add New Admin"}),e.jsxs("div",{className:"mt-4 space-y-4",children:[b&&e.jsx("div",{className:"rounded-md bg-red-50 p-2 mb-3",children:e.jsx("div",{className:"flex",children:e.jsx("div",{className:"ml-2",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:b})})})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",name:"name",id:"name",value:f.name,onChange:j=>N({...f,name:j.target.value}),className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",id:"email",value:f.email,onChange:j=>N({...f,email:j.target.value}),className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"company",className:"block text-sm font-medium text-gray-700",children:"Company"}),e.jsx("input",{type:"text",name:"company",id:"company",value:f.company,onChange:j=>N({...f,company:j.target.value}),className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx("input",{type:"password",name:"password",id:"password",value:f.password,onChange:j=>N({...f,password:j.target.value}),className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:!0})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:_,children:"Add Admin"}),e.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>n(!1),children:"Cancel"})]})]})]})}),l&&h&&e.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[e.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:["Edit Admin: ",h.name]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-name",className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",name:"name",id:"edit-name",value:p.name,onChange:j=>y({...p,name:j.target.value}),className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-email",className:"block text-sm font-medium text-gray-700",children:"Email (read-only)"}),e.jsx("input",{type:"email",name:"email",id:"edit-email",value:p.email,disabled:!0,className:"mt-1 bg-gray-100 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-company",className:"block text-sm font-medium text-gray-700",children:"Company"}),e.jsx("input",{type:"text",name:"company",id:"edit-company",value:p.company,onChange:j=>y({...p,company:j.target.value}),className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]})]})})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:$,children:"Save Changes"}),e.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>{c(!1),d(null)},children:"Cancel"})]})]})]})}),i&&h&&e.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx($e,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:"Delete Admin"}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["Are you sure you want to delete ",h.name,"? This action cannot be undone."]})})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:A,children:"Delete"}),e.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>{o(!1),d(null)},children:"Cancel"})]})]})]})})]})},ma=()=>{const{user:a}=oe(),[t,s]=v.useState(()=>{try{const f=sessionStorage.getItem("global_branding_settings");if(f){const N=JSON.parse(f);return console.log("Using cached branding settings from state init"),{primaryColor:N.primaryColor||C.primaryColor,secondaryColor:N.secondaryColor||C.secondaryColor,accentColor:N.accentColor||C.accentColor,textColor:N.textColor||C.textColor,backgroundColor:N.backgroundColor||C.backgroundColor,logo:null,logoPreview:N.logoPreview||"",appDomain:N.appDomain||""}}}catch(f){console.error("Error reading cached settings:",f)}return{primaryColor:C.primaryColor,secondaryColor:C.secondaryColor,accentColor:C.accentColor,textColor:C.textColor,backgroundColor:C.backgroundColor,logo:null,logoPreview:"",appDomain:""}}),[r,n]=v.useState(!1),[i,o]=v.useState(!1),[l,c]=v.useState(!1),[h,d]=v.useState("");v.useEffect(()=>{const f=setTimeout(()=>{l&&(console.warn("Loading state was stuck, forcing it to false"),c(!1))},3e3);return(async()=>{console.log("Loading branding settings from Supabase"),c(!0),d("");try{const p=sessionStorage.getItem("global_branding_settings");if(p)try{const _=JSON.parse(p);console.log("Using cached branding settings:",_),s(A=>({...A,primaryColor:_.primaryColor||A.primaryColor,secondaryColor:_.secondaryColor||A.secondaryColor,accentColor:_.accentColor||A.accentColor,textColor:_.textColor||A.textColor,backgroundColor:_.backgroundColor||A.backgroundColor,logoPreview:_.logoPreview||A.logoPreview,appDomain:_.appDomain||A.appDomain,logo:null}))}catch(_){console.error("Error parsing cached settings:",_)}const{data:y,error:S}=await R.from("global_settings").select("*").eq("type","branding").single();if(S)if(S.code==="PGRST116")console.log("No branding settings found, using defaults");else throw console.error("Error loading settings from Supabase:",S),S;if(y&&y.settings){console.log("Loaded branding from Supabase:",y.settings);try{const _=typeof y.settings=="string"?JSON.parse(y.settings):y.settings;if(typeof _=="object"&&_!==null){if(sessionStorage.setItem("global_branding_settings",JSON.stringify(_)),s(A=>({...A,primaryColor:_.primaryColor||A.primaryColor,secondaryColor:_.secondaryColor||A.secondaryColor,accentColor:_.accentColor||A.accentColor,textColor:_.textColor||A.textColor,backgroundColor:_.backgroundColor||A.backgroundColor,logoPreview:_.logoPreview||A.logoPreview,appDomain:_.appDomain||A.appDomain,logo:null})),_.logoPreview&&_.logoPreview.startsWith("blob:"))try{console.log("Converting blob URL to data URL for persistence");const $=await(await fetch(_.logoPreview)).blob(),L=new FileReader;L.onload=function(){const j=L.result;s(ee=>({...ee,logoPreview:j}));const z={..._,logoPreview:j};sessionStorage.setItem("global_branding_settings",JSON.stringify(z))},L.readAsDataURL($)}catch(A){console.error("Error converting blob URL:",A)}}else throw new Error("Invalid branding data format")}catch(_){console.error("Error parsing saved global branding from Supabase:",_),s(A=>({...A,primaryColor:C.primaryColor,secondaryColor:C.secondaryColor,accentColor:C.accentColor,textColor:C.textColor,backgroundColor:C.backgroundColor})),d("Error loading saved branding settings, reverting to defaults")}}}catch(p){console.error("Error loading global branding:",p),d("Failed to load branding settings")}finally{c(!1)}})(),()=>{clearTimeout(f)}},[]),v.useEffect(()=>{document.documentElement.style.setProperty("--global-primary-color",t.primaryColor),document.documentElement.style.setProperty("--global-secondary-color",t.secondaryColor),console.log("Applied global branding settings:",t)},[t.primaryColor,t.secondaryColor]);const u=f=>{const{name:N,value:p}=f.target;s({...t,[N]:p})},m=f=>{const{value:N}=f.target;s({...t,appDomain:N})},g=f=>{if(f.target.files&&f.target.files[0]){const N=f.target.files[0],p=new FileReader;p.onload=function(){const y=p.result;s({...t,logo:N,logoPreview:y});const _={...JSON.parse(sessionStorage.getItem("global_branding_settings")||"{}"),logoPreview:y};sessionStorage.setItem("global_branding_settings",JSON.stringify(_))},p.readAsDataURL(N)}},x=async()=>{const f={primaryColor:C.primaryColor,secondaryColor:C.secondaryColor,accentColor:C.accentColor,textColor:C.textColor,backgroundColor:C.backgroundColor,logo:null,logoPreview:"",appDomain:""};s(f),n(!0);try{const{error:N}=await R.from("global_settings").delete().eq("type","branding");if(N)throw console.error("Error deleting branding settings from Supabase:",N),N;localStorage.setItem("brandSettings",JSON.stringify({logo:"",primaryColor:C.primaryColor,secondaryColor:C.secondaryColor})),console.log("Global branding settings reset to defaults"),o(!0),setTimeout(()=>o(!1),3e3)}catch(N){console.error("Error resetting branding settings:",N),d("Failed to reset branding settings. Please try again.")}finally{n(!1)}},b=async()=>{n(!0),d("");try{const f={primaryColor:t.primaryColor,secondaryColor:t.secondaryColor,accentColor:t.accentColor,textColor:t.textColor,backgroundColor:t.backgroundColor,logoPreview:t.logoPreview,appDomain:t.appDomain};sessionStorage.setItem("global_branding_settings",JSON.stringify(f));const{data:N}=await R.from("global_settings").select("id").eq("type","branding").single();let p;if(N?p=await R.from("global_settings").update({settings:f,updated_at:new Date().toISOString()}).eq("type","branding"):p=await R.from("global_settings").insert([{type:"branding",settings:f,created_by:(a==null?void 0:a.id)||null}]),p.error)throw console.error("Error saving branding to Supabase:",p.error),p.error;console.log("Global branding settings saved to Supabase:",f),localStorage.setItem("brandSettings",JSON.stringify({logo:f.logoPreview,primaryColor:f.primaryColor,secondaryColor:f.secondaryColor})),document.documentElement.style.setProperty("--global-primary-color",t.primaryColor),document.documentElement.style.setProperty("--global-secondary-color",t.secondaryColor),o(!0),setTimeout(()=>o(!1),3e3)}catch(f){console.error("Error saving global branding settings:",f),d("Failed to save branding settings. Please try again.")}finally{n(!1)}},w=async()=>{c(!0),d("");try{const{data:f,error:N}=await R.from("global_settings").select("*").eq("type","branding").single();if(N)if(N.code==="PGRST116")console.log("No branding settings found in database"),s({primaryColor:C.primaryColor,secondaryColor:C.secondaryColor,accentColor:C.accentColor,textColor:C.textColor,backgroundColor:C.backgroundColor,logo:null,logoPreview:"",appDomain:""});else throw console.error("Error fetching branding settings:",N),N;else if(f&&f.settings){console.log("Refreshed branding from Supabase:",f.settings);const p=typeof f.settings=="string"?JSON.parse(f.settings):f.settings;if(typeof p=="object"&&p!==null)s(y=>({...y,primaryColor:p.primaryColor||y.primaryColor,secondaryColor:p.secondaryColor||y.secondaryColor,accentColor:p.accentColor||y.accentColor,textColor:p.textColor||y.textColor,backgroundColor:p.backgroundColor||y.backgroundColor,logoPreview:p.logoPreview||y.logoPreview,appDomain:p.appDomain||y.appDomain,logo:null})),localStorage.setItem("brandSettings",JSON.stringify({logo:p.logoPreview,primaryColor:p.primaryColor,secondaryColor:p.secondaryColor})),document.documentElement.style.setProperty("--global-primary-color",p.primaryColor),document.documentElement.style.setProperty("--global-secondary-color",p.secondaryColor);else throw new Error("Invalid branding data format")}}catch(f){console.error("Error refreshing branding settings:",f),d("Failed to refresh branding settings from the database")}finally{c(!1)}};return e.jsx(B,{title:"Global Branding",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Branding Settings"}),e.jsxs("button",{onClick:w,className:"inline-flex items-center text-sm text-blue-600 hover:text-blue-800",disabled:l,children:[e.jsx(qs,{className:"h-4 w-4 mr-1"}),"Refresh"]})]}),l&&e.jsxs("div",{className:"mb-4 flex items-center text-blue-500",children:[e.jsx("div",{className:"animate-spin mr-2 h-5 w-5 border-2 border-blue-500 border-t-transparent rounded-full"}),e.jsx("span",{children:"Loading settings..."})]}),h&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border-l-4 border-red-500 text-red-700",children:h}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logo"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-16 w-16 bg-gray-100 rounded-md overflow-hidden flex items-center justify-center",children:t.logoPreview?e.jsx("img",{src:t.logoPreview,alt:"Logo preview",className:"h-full w-full object-contain"}):e.jsx("span",{className:"text-gray-400",children:"No logo"})}),e.jsxs("div",{className:"ml-5",children:[e.jsxs("div",{className:"relative bg-white rounded-md shadow-sm",children:[e.jsx("input",{type:"file",id:"logo",name:"logo",accept:"image/*",onChange:g,className:"sr-only"}),e.jsx("label",{htmlFor:"logo",className:"cursor-pointer py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Choose file"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"PNG, JPG, GIF up to 2MB"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"appDomain",className:"block text-sm font-medium text-gray-700 mb-1",children:"App Domain"}),e.jsx("div",{className:"flex items-center",children:e.jsx("input",{type:"text",id:"appDomain",name:"appDomain",value:t.appDomain,onChange:m,placeholder:"https://your-app-domain.com",className:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The domain where your consent script will be hosted. Used to generate code snippets."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"primaryColor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Color"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"color",id:"primaryColor",name:"primaryColor",value:t.primaryColor,onChange:u,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:t.primaryColor,onChange:u,name:"primaryColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"secondaryColor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Secondary Color"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"color",id:"secondaryColor",name:"secondaryColor",value:t.secondaryColor,onChange:u,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:t.secondaryColor,onChange:u,name:"secondaryColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"accentColor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Accent Color"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"color",id:"accentColor",name:"accentColor",value:t.accentColor,onChange:u,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:t.accentColor,onChange:u,name:"accentColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"textColor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Text Color"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"color",id:"textColor",name:"textColor",value:t.textColor,onChange:u,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:t.textColor,onChange:u,name:"textColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"backgroundColor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Background Color"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"color",id:"backgroundColor",name:"backgroundColor",value:t.backgroundColor,onChange:u,className:"h-8 w-8 rounded-md border border-gray-300 cursor-pointer"}),e.jsx("input",{type:"text",value:t.backgroundColor,onChange:u,name:"backgroundColor",className:"ml-2 flex-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsxs("button",{type:"button",onClick:x,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(qt,{className:"h-4 w-4 mr-2"}),"Reset to Default"]}),e.jsxs("button",{type:"button",onClick:b,disabled:r,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),r?"Saving...":i?"Saved!":"Save Changes"]})]})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Preview"}),t.appDomain&&e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-md",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Installation Code"}),e.jsx("code",{className:"block p-2 bg-gray-100 rounded border text-xs overflow-x-auto whitespace-pre",children:`<script src="${t.appDomain.replace(/\/$/,"")}/consent.js"><\/script>
<script>
  window.ConsentHub.init({
    clientId: "YOUR_CLIENT_ID"
  });
<\/script>`})]}),e.jsxs("div",{className:"border rounded-lg overflow-hidden",style:{backgroundColor:t.backgroundColor},children:[e.jsxs("div",{className:"p-3 flex items-center",style:{backgroundColor:t.primaryColor},children:[t.logoPreview&&e.jsx("img",{src:t.logoPreview,alt:"Logo",className:"h-6 mr-2"}),e.jsx("span",{className:"font-medium text-white",children:"ConsentHub"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",style:{color:t.textColor},children:"Cookie Consent"}),e.jsx("p",{className:"text-xs mb-3",style:{color:t.textColor},children:'We use cookies to enhance your experience on our website. By clicking "Accept All", you consent to the use of all cookies.'}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:"text-xs px-3 py-1 rounded-md",style:{backgroundColor:t.secondaryColor,color:"white"},children:"Accept All"}),e.jsx("button",{className:"text-xs px-3 py-1 rounded-md",style:{backgroundColor:"transparent",color:t.accentColor,border:`1px solid ${t.accentColor}`},children:"Customize"}),e.jsx("button",{className:"text-xs px-3 py-1 rounded-md",style:{backgroundColor:"transparent",color:t.textColor,border:`1px solid ${t.textColor}`,opacity:.7},children:"Reject All"})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Branding Presets"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",className:"p-3 border rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>{s({...t,primaryColor:"#3B82F6",secondaryColor:"#1E40AF",accentColor:"#60A5FA",textColor:"#1F2937",backgroundColor:"#F9FAFB"})},children:[e.jsxs("div",{className:"flex space-x-1 mb-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-500"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-800"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-400"})]}),e.jsx("span",{className:"text-xs text-gray-700",children:"Blue Theme"})]}),e.jsxs("button",{type:"button",className:"p-3 border rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>{s({...t,primaryColor:"#10B981",secondaryColor:"#065F46",accentColor:"#34D399",textColor:"#1F2937",backgroundColor:"#F9FAFB"})},children:[e.jsxs("div",{className:"flex space-x-1 mb-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-green-500"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-green-800"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-green-400"})]}),e.jsx("span",{className:"text-xs text-gray-700",children:"Green Theme"})]}),e.jsxs("button",{type:"button",className:"p-3 border rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>{s({...t,primaryColor:"#8B5CF6",secondaryColor:"#5B21B6",accentColor:"#A78BFA",textColor:"#1F2937",backgroundColor:"#F9FAFB"})},children:[e.jsxs("div",{className:"flex space-x-1 mb-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-purple-500"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-purple-800"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-purple-400"})]}),e.jsx("span",{className:"text-xs text-gray-700",children:"Purple Theme"})]}),e.jsxs("button",{type:"button",className:"p-3 border rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>{s({...t,primaryColor:"#111827",secondaryColor:"#374151",accentColor:"#6B7280",textColor:"#F9FAFB",backgroundColor:"#1F2937"})},children:[e.jsxs("div",{className:"flex space-x-1 mb-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-900"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-700"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-gray-500"})]}),e.jsx("span",{className:"text-xs text-gray-700",children:"Dark Theme"})]})]})]})]})})]})})},fa=()=>{const[a,t]=v.useState("last30"),s=[{name:"Total Impressions",value:"1.2M",change:"+12%",trend:"up"},{name:"Consent Rate",value:"87%",change:"+5%",trend:"up"},{name:"Rejection Rate",value:"8%",change:"-2%",trend:"down"},{name:"Customized Consents",value:"5%",change:"+1%",trend:"up"}],r=[{domain:"acme.com",impressions:245e3,consentRate:92},{domain:"globex.com",impressions:187e3,consentRate:88},{domain:"initech.com",impressions:156e3,consentRate:85},{domain:"umbrella.com",impressions:134e3,consentRate:81},{domain:"stark.com",impressions:98e3,consentRate:79}],n=i=>{t(i.target.value)};return e.jsx(B,{title:"Global Analytics",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx("div",{className:"bg-white shadow rounded-lg p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(dt,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"w-full sm:w-48",children:[e.jsx("label",{htmlFor:"dateRange",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Range"}),e.jsxs("select",{id:"dateRange",name:"dateRange",value:a,onChange:n,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"yesterday",children:"Yesterday"}),e.jsx("option",{value:"last7",children:"Last 7 days"}),e.jsx("option",{value:"last30",children:"Last 30 days"}),e.jsx("option",{value:"thisMonth",children:"This month"}),e.jsx("option",{value:"lastMonth",children:"Last month"}),e.jsx("option",{value:"custom",children:"Custom range"})]})]}),e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx("label",{htmlFor:"exportData",className:"block text-sm font-medium text-gray-700 mb-1",children:"Export Data"}),e.jsxs("button",{type:"button",className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 w-full sm:w-auto",children:[e.jsx(ct,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map(i=>e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:i.name.includes("Impressions")?e.jsx(W,{className:"h-6 w-6 text-blue-600"}):i.name.includes("Consent")?e.jsx(ht,{className:"h-6 w-6 text-green-600"}):i.name.includes("Rejection")?e.jsx(mt,{className:"h-6 w-6 text-red-600"}):e.jsx(lt,{className:"h-6 w-6 text-purple-600"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:i.name}),e.jsxs("dd",{className:"flex items-baseline",children:[e.jsx("div",{className:"text-lg font-medium text-gray-900",children:i.value}),e.jsx("div",{className:`ml-2 flex items-center text-sm font-semibold ${i.trend==="up"?"text-green-600":"text-red-600"}`,children:i.change})]})]})})]})})},i.name))}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Consent Rate Trends"}),e.jsx("div",{className:"h-80 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Consent rate trend chart will be displayed here"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Consent by Category"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Consent category chart will be displayed here"})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Consent by Country"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Geographical consent chart will be displayed here"})})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Top Performing Domains"}),e.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Domains with highest consent rates and impressions."})]}),e.jsx("div",{className:"border-t border-gray-200",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Domain"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Impressions"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Consent Rate"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(i=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:i.domain}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:i.impressions.toLocaleString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[i.consentRate,"%"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${i.consentRate}%`}})})})]},i.domain))})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Device Breakdown"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Device analytics chart will be displayed here"})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Browser Breakdown"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Browser analytics chart will be displayed here"})})]})]})]})})},xa=()=>e.jsxs(B,{title:"Dashboard",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(me,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Active Websites"}),e.jsx("dd",{children:e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"3"})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"#",className:"font-medium text-blue-600 hover:text-blue-500",children:"View all"})})})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(W,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Consents"}),e.jsx("dd",{children:e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"24.5K"})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"/client/analytics",className:"font-medium text-blue-600 hover:text-blue-500",children:"View analytics"})})})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:[e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ut,{className:"h-6 w-6 text-green-500"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Consent Rate"}),e.jsx("dd",{children:e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"78.3%"})})]})})]})}),e.jsx("div",{className:"bg-gray-50 px-5 py-3",children:e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"/client/analytics",className:"font-medium text-blue-600 hover:text-blue-500",children:"View details"})})})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-lg leading-6 font-medium text-gray-900",children:"Your Consent Script"}),e.jsx("div",{className:"mt-2 bg-gray-800 rounded-lg p-4 text-white font-mono text-sm overflow-auto",children:e.jsx("pre",{children:`<script>
  (function() {
    // ConsentHub Script
    var ch = document.createElement('script');
    ch.type = 'text/javascript';
    ch.async = true;
    ch.src = 'https://cdn.consenthub.com/loader.js';
    ch.setAttribute('data-client-id', 'client-123456');
    ch.setAttribute('data-domain', 'example.com');
    
    // Branding settings
    ch.setAttribute('data-primary-color', '#3B82F6');
    ch.setAttribute('data-secondary-color', '#1E40AF');
    ch.setAttribute('data-position', 'bottom');
    ch.setAttribute('data-theme', 'light');
    
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ch, s);
  })();
<\/script>`})})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h2",{className:"text-lg leading-6 font-medium text-gray-900",children:"Recent Activity"}),e.jsx("div",{className:"mt-2 bg-white shadow overflow-hidden sm:rounded-md",children:e.jsxs("ul",{className:"divide-y divide-gray-200",children:[e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 truncate",children:"Consent popup viewed"}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:"Impression"})})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsx("div",{className:"sm:flex",children:e.jsx("p",{className:"flex items-center text-sm text-gray-500",children:"example.com/home"})}),e.jsx("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:e.jsx("p",{children:"Just now"})})]})]})}),e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 truncate",children:"Consent accepted"}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Accepted"})})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsx("div",{className:"sm:flex",children:e.jsx("p",{className:"flex items-center text-sm text-gray-500",children:"example.com/products"})}),e.jsx("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:e.jsx("p",{children:"5 minutes ago"})})]})]})}),e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 truncate",children:"Consent rejected"}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:"Rejected"})})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsx("div",{className:"sm:flex",children:e.jsx("p",{className:"flex items-center text-sm text-gray-500",children:"example.com/blog"})}),e.jsx("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:e.jsx("p",{children:"1 hour ago"})})]})]})})]})})]})]}),ga=()=>{const[a,t]=v.useState("last30"),s=[{name:"Total Impressions",value:"45,892",change:"+12%",trend:"up"},{name:"Consent Rate",value:"78%",change:"+5%",trend:"up"},{name:"Rejection Rate",value:"15%",change:"-3%",trend:"down"},{name:"Customized Consents",value:"7%",change:"+2%",trend:"up"}],r=[{page:"/",impressions:12500,consentRate:82},{page:"/products",impressions:8700,consentRate:79},{page:"/about",impressions:6200,consentRate:85},{page:"/contact",impressions:4800,consentRate:76},{page:"/blog",impressions:3900,consentRate:81}],n=i=>{t(i.target.value)};return e.jsx(B,{title:"Analytics",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsx("div",{className:"bg-white shadow rounded-lg p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(dt,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"w-full sm:w-48",children:[e.jsx("label",{htmlFor:"dateRange",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Range"}),e.jsxs("select",{id:"dateRange",name:"dateRange",value:a,onChange:n,className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"yesterday",children:"Yesterday"}),e.jsx("option",{value:"last7",children:"Last 7 days"}),e.jsx("option",{value:"last30",children:"Last 30 days"}),e.jsx("option",{value:"thisMonth",children:"This month"}),e.jsx("option",{value:"lastMonth",children:"Last month"}),e.jsx("option",{value:"custom",children:"Custom range"})]})]}),e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx("label",{htmlFor:"exportData",className:"block text-sm font-medium text-gray-700 mb-1",children:"Export Data"}),e.jsxs("button",{type:"button",className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 w-full sm:w-auto",children:[e.jsx(ct,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map(i=>e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:i.name.includes("Impressions")?e.jsx(W,{className:"h-6 w-6 text-blue-600"}):i.name.includes("Consent")?e.jsx(ht,{className:"h-6 w-6 text-green-600"}):i.name.includes("Rejection")?e.jsx(mt,{className:"h-6 w-6 text-red-600"}):e.jsx(lt,{className:"h-6 w-6 text-purple-600"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:i.name}),e.jsxs("dd",{className:"flex items-baseline",children:[e.jsx("div",{className:"text-lg font-medium text-gray-900",children:i.value}),e.jsx("div",{className:`ml-2 flex items-center text-sm font-semibold ${i.trend==="up"?"text-green-600":"text-red-600"}`,children:i.change})]})]})})]})})},i.name))}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Consent Rate Trends"}),e.jsx("div",{className:"h-80 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Consent rate trend chart will be displayed here"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Consent by Category"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Consent category chart will be displayed here"})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Consent by Country"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Geographical consent chart will be displayed here"})})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Top Performing Pages"}),e.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Pages with highest consent rates and impressions."})]}),e.jsx("div",{className:"border-t border-gray-200",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Page"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Impressions"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Consent Rate"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performance"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(i=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:i.page}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:i.impressions.toLocaleString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[i.consentRate,"%"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${i.consentRate}%`}})})})]},i.page))})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Device Breakdown"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Device analytics chart will be displayed here"})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Browser Breakdown"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Browser analytics chart will be displayed here"})})]})]})]})})};function pa(){return v.useEffect(()=>{(async()=>{try{const{data:s,error:r}=await R.auth.refreshSession();console.log("Session refresh on app load:",r?"failed":"success")}catch(s){console.error("Error refreshing session on app load:",s)}})();try{const s=sessionStorage.getItem("redirect");if(s){sessionStorage.removeItem("redirect");const{pathname:r}=JSON.parse(s);setTimeout(()=>{window.history.replaceState(null,"",r),window.dispatchEvent(new Event("popstate"))},0)}}catch(s){console.error("Error handling redirect:",s)}const t=s=>{var r;(r=s.key)!=null&&r.includes("supabase")&&!s.newValue&&console.warn("Supabase session was cleared from storage!")};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[]),e.jsx(bs,{children:e.jsx(ea,{children:e.jsxs(vs,{children:[e.jsx(I,{path:"/",element:e.jsx(sa,{})}),e.jsx(I,{path:"/login",element:e.jsx(ta,{})}),e.jsx(I,{path:"/superadmin",element:e.jsx(Re,{children:e.jsx(ha,{})})}),e.jsx(I,{path:"/superadmin/admins",element:e.jsx(Re,{children:e.jsx(ua,{})})}),e.jsx(I,{path:"/superadmin/branding",element:e.jsx(Re,{children:e.jsx(ma,{})})}),e.jsx(I,{path:"/superadmin/analytics",element:e.jsx(Re,{children:e.jsx(fa,{})})}),e.jsx(I,{path:"/admin",element:e.jsx(se,{children:e.jsx(ra,{})})}),e.jsx(I,{path:"/admin/clients",element:e.jsx(se,{children:e.jsx(oa,{})})}),e.jsx(I,{path:"/admin/branding",element:e.jsx(se,{children:e.jsx(ia,{})})}),e.jsx(I,{path:"/admin/code",element:e.jsx(se,{children:e.jsx(It,{})})}),e.jsx(I,{path:"/admin/code/:clientId",element:e.jsx(se,{children:e.jsx(It,{})})}),e.jsx(I,{path:"/admin/client/:clientId",element:e.jsx(se,{children:e.jsx(da,{})})}),e.jsx(I,{path:"/admin/analytics",element:e.jsx(se,{children:e.jsx(ca,{})})}),e.jsx(I,{path:"/client",element:e.jsx($t,{children:e.jsx(xa,{})})}),e.jsx(I,{path:"/client/analytics",element:e.jsx($t,{children:e.jsx(ga,{})})}),e.jsx(I,{path:"*",element:e.jsx(Le,{to:"/",replace:!0})})]})})})}const ya=()=>{var a;try{const s="sb-fgnvobekfychilwomxij-auth-token",r=localStorage.getItem(s);if(r){const n=JSON.parse(r);console.log("Found persisted session for:",((a=n==null?void 0:n.user)==null?void 0:a.email)||"unknown user")}else console.log("No persisted session found in localStorage")}catch(t){console.error("Error checking persisted session:",t)}};ya();Xe.createRoot(document.getElementById("root")).render(e.jsx(ws.StrictMode,{children:e.jsx(pa,{})}));
